!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.r=function(exports){Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./atomic_test.ts")}({"../check/any-type.ts":
/*!****************************!*\
  !*** ../check/any-type.ts ***!
  \****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnyType=function AnyType(){return{check:_=>!0,toString:()=>"(any)"}}},"../check/array-of-type.ts":
/*!*********************************!*\
  !*** ../check/array-of-type.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const instanceof_type_1=__webpack_require__(/*! ../check/instanceof-type */"../check/instanceof-type.ts");exports.ArrayOfType=function ArrayOfType(type){return{check:target=>!!instanceof_type_1.InstanceofType(Array).check(target)&&target.every(element=>type.check(element)),toString:()=>`${type}[]`}}},"../check/boolean-type.ts":
/*!********************************!*\
  !*** ../check/boolean-type.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BooleanType={check:target=>"boolean"==typeof target||target instanceof Boolean,toString:()=>"boolean"}},"../check/element-with-tag-type.ts":
/*!*****************************************!*\
  !*** ../check/element-with-tag-type.ts ***!
  \*****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ElementWithTagType=function ElementWithTagType(tag){return{check:target=>target instanceof HTMLElement&&target.tagName.toLowerCase()===tag.toLowerCase(),toString:()=>`HTMLElement(${tag})`}}},"../check/enum-type.ts":
/*!*****************************!*\
  !*** ../check/enum-type.ts ***!
  \*****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EnumType=function EnumType(enumType){return{check:target=>void 0!==enumType[target],toString:()=>"Enum"}}},"../check/finite-iterable-of-type.ts":
/*!*******************************************!*\
  !*** ../check/finite-iterable-of-type.ts ***!
  \*******************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const finite_iterable_type_1=__webpack_require__(/*! ../check/finite-iterable-type */"../check/finite-iterable-type.ts");exports.FiniteIterableOfType=function FiniteIterableOfType(type){return{check(target){if(!finite_iterable_type_1.FiniteIterableType.check(target))return!1;for(const item of target)if(!type.check(item))return!1;return!0},toString:()=>`(Finite & Iterable<${type}>)`}}},"../check/finite-iterable-type.ts":
/*!****************************************!*\
  !*** ../check/finite-iterable-type.ts ***!
  \****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const has_property_type_1=__webpack_require__(/*! ../check/has-property-type */"../check/has-property-type.ts"),instanceof_type_1=__webpack_require__(/*! ../check/instanceof-type */"../check/instanceof-type.ts"),intersect_type_1=__webpack_require__(/*! ../check/intersect-type */"../check/intersect-type.ts"),iterable_type_1=__webpack_require__(/*! ../check/iterable-type */"../check/iterable-type.ts");exports.FiniteIterableType=intersect_type_1.IntersectType.builder().addType(iterable_type_1.IterableType).addType(has_property_type_1.HasPropertyType("size",instanceof_type_1.InstanceofType(Function))).build()},"../check/has-properties-type.ts":
/*!***************************************!*\
  !*** ../check/has-properties-type.ts ***!
  \***************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HasPropertiesType=function HasPropertiesType(spec){return{check(target){if(!(target instanceof Object))return!1;for(const key in spec)if(!spec[key].check(target[key]))return!1;return!0},toString(){const entries=[];for(const key in spec)entries.push(`${key}: ${spec[key]}`);return`{${entries.join(", ")}}`}}}},"../check/has-property-type.ts":
/*!*************************************!*\
  !*** ../check/has-property-type.ts ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HasPropertyType=function HasPropertyType(name,type){return{check(target){if(!target)return!1;const value=target[name];return void 0!==value&&type.check(value)},toString:()=>`{${name}: ${type}}`}}},"../check/index.ts":
/*!*************************!*\
  !*** ../check/index.ts ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var any_type_1=__webpack_require__(/*! ./any-type */"../check/any-type.ts");exports.AnyType=any_type_1.AnyType;var array_of_type_1=__webpack_require__(/*! ./array-of-type */"../check/array-of-type.ts");exports.ArrayOfType=array_of_type_1.ArrayOfType;var boolean_type_1=__webpack_require__(/*! ./boolean-type */"../check/boolean-type.ts");exports.BooleanType=boolean_type_1.BooleanType;var element_with_tag_type_1=__webpack_require__(/*! ./element-with-tag-type */"../check/element-with-tag-type.ts");exports.ElementWithTagType=element_with_tag_type_1.ElementWithTagType;var enum_type_1=__webpack_require__(/*! ./enum-type */"../check/enum-type.ts");exports.EnumType=enum_type_1.EnumType;var finite_iterable_type_1=__webpack_require__(/*! ./finite-iterable-type */"../check/finite-iterable-type.ts");exports.FiniteIterableType=finite_iterable_type_1.FiniteIterableType;var finite_iterable_of_type_1=__webpack_require__(/*! ./finite-iterable-of-type */"../check/finite-iterable-of-type.ts");exports.FiniteIterableOfType=finite_iterable_of_type_1.FiniteIterableOfType;var has_properties_type_1=__webpack_require__(/*! ./has-properties-type */"../check/has-properties-type.ts");exports.HasPropertiesType=has_properties_type_1.HasPropertiesType;var has_property_type_1=__webpack_require__(/*! ./has-property-type */"../check/has-property-type.ts");exports.HasPropertyType=has_property_type_1.HasPropertyType;var instanceof_type_1=__webpack_require__(/*! ./instanceof-type */"../check/instanceof-type.ts");exports.InstanceofType=instanceof_type_1.InstanceofType;var intersect_type_1=__webpack_require__(/*! ./intersect-type */"../check/intersect-type.ts");exports.IntersectType=intersect_type_1.IntersectType;var iterable_of_type_1=__webpack_require__(/*! ./iterable-of-type */"../check/iterable-of-type.ts");exports.IterableOfType=iterable_of_type_1.IterableOfType;var iterable_type_1=__webpack_require__(/*! ./iterable-type */"../check/iterable-type.ts");exports.IterableType=iterable_type_1.IterableType;var non_null_type_1=__webpack_require__(/*! ./non-null-type */"../check/non-null-type.ts");exports.NonNullType=non_null_type_1.NonNullType;var null_type_1=__webpack_require__(/*! ./null-type */"../check/null-type.ts");exports.NullType=null_type_1.NullType;var nullable_type_1=__webpack_require__(/*! ./nullable-type */"../check/nullable-type.ts");exports.NullableType=nullable_type_1.NullableType;var number_type_1=__webpack_require__(/*! ./number-type */"../check/number-type.ts");exports.NumberType=number_type_1.NumberType;var object_type_1=__webpack_require__(/*! ./object-type */"../check/object-type.ts");exports.ObjectType=object_type_1.ObjectType;var string_type_1=__webpack_require__(/*! ./string-type */"../check/string-type.ts");exports.StringType=string_type_1.StringType;var symbol_type_1=__webpack_require__(/*! ./symbol-type */"../check/symbol-type.ts");exports.SymbolType=symbol_type_1.SymbolType;var tuple_of_type_1=__webpack_require__(/*! ./tuple-of-type */"../check/tuple-of-type.ts");exports.TupleOfType=tuple_of_type_1.TupleOfType;var undefined_type_1=__webpack_require__(/*! ./undefined-type */"../check/undefined-type.ts");exports.UndefinedType=undefined_type_1.UndefinedType;var union_type_1=__webpack_require__(/*! ./union-type */"../check/union-type.ts");exports.UnionType=union_type_1.UnionType},"../check/instanceof-type.ts":
/*!***********************************!*\
  !*** ../check/instanceof-type.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InstanceofType=function InstanceofType(ctor){return{check:target=>target instanceof ctor,toString:()=>`(instanceof ${ctor.name})`}}},"../check/intersect-type.ts":
/*!**********************************!*\
  !*** ../check/intersect-type.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class IntersectTypeBuilder{constructor(){this.types_=[]}addType(type){return this.types_.push(type),this}build(){return new IntersectType(this.types_.slice())}}class IntersectType{constructor(types){this.types_=types}check(target){return this.types_.every(type=>type.check(target))}toString(){return`(${this.types_.map(type=>`${type}`).join(" & ")})`}static builder(){return new IntersectTypeBuilder}}exports.IntersectType=IntersectType},"../check/iterable-of-type.ts":
/*!************************************!*\
  !*** ../check/iterable-of-type.ts ***!
  \************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const has_properties_type_1=__webpack_require__(/*! ../check/has-properties-type */"../check/has-properties-type.ts"),instanceof_type_1=__webpack_require__(/*! ../check/instanceof-type */"../check/instanceof-type.ts"),IterableType=has_properties_type_1.HasPropertiesType({[Symbol.iterator]:instanceof_type_1.InstanceofType(Function)});exports.IterableOfType=function IterableOfType(type){return{check(target){if(!IterableType.check(target))return!1;for(const item of target)if(!type.check(item))return!1;return!0},toString:()=>`Iterable<${type}>`}}},"../check/iterable-type.ts":
/*!*********************************!*\
  !*** ../check/iterable-type.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const has_property_type_1=__webpack_require__(/*! ../check/has-property-type */"../check/has-property-type.ts"),instanceof_type_1=__webpack_require__(/*! ../check/instanceof-type */"../check/instanceof-type.ts");exports.IterableType=has_property_type_1.HasPropertyType(Symbol.iterator,instanceof_type_1.InstanceofType(Function))},"../check/non-null-type.ts":
/*!*********************************!*\
  !*** ../check/non-null-type.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NonNullType=function NonNullType(){return{check:target=>null!==target,toString:()=>"(!== null)"}}},"../check/null-type.ts":
/*!*****************************!*\
  !*** ../check/null-type.ts ***!
  \*****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NullType={check:target=>null===target,toString:()=>"null"}},"../check/nullable-type.ts":
/*!*********************************!*\
  !*** ../check/nullable-type.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const null_type_1=__webpack_require__(/*! ../check/null-type */"../check/null-type.ts"),union_type_1=__webpack_require__(/*! ../check/union-type */"../check/union-type.ts");exports.NullableType=function NullableType(type){return union_type_1.UnionType.builder().addType(type).addType(null_type_1.NullType).build()}},"../check/number-type.ts":
/*!*******************************!*\
  !*** ../check/number-type.ts ***!
  \*******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NumberType={check:target=>"number"==typeof target||target instanceof Number,toString:()=>"number"}},"../check/object-type.ts":
/*!*******************************!*\
  !*** ../check/object-type.ts ***!
  \*******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const instanceof_type_1=__webpack_require__(/*! ../check/instanceof-type */"../check/instanceof-type.ts"),number_type_1=__webpack_require__(/*! ../check/number-type */"../check/number-type.ts"),string_type_1=__webpack_require__(/*! ../check/string-type */"../check/string-type.ts");class GenericObjectType{constructor(keyType_,valueType_){this.keyType_=keyType_,this.valueType_=valueType_}check(target){if(!instanceof_type_1.InstanceofType(Object).check(target))return!1;for(const key in target){if(!this.keyType_.check(key))return!1;if(!this.valueType_.check(target[key]))return!1}return!0}toString(){return`{[key: ${this.keyType_}]: ${this.valueType_}}`}}exports.ObjectType={numberKeyed:valueType=>new GenericObjectType(number_type_1.NumberType,valueType),stringKeyed:valueType=>new GenericObjectType(string_type_1.StringType,valueType)}},"../check/string-type.ts":
/*!*******************************!*\
  !*** ../check/string-type.ts ***!
  \*******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StringType={check:target=>"string"==typeof target||target instanceof String,toString:()=>"string"}},"../check/symbol-type.ts":
/*!*******************************!*\
  !*** ../check/symbol-type.ts ***!
  \*******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SymbolType={check:target=>"symbol"==typeof target,toString:()=>"symbol"}},"../check/tuple-of-type.ts":
/*!*********************************!*\
  !*** ../check/tuple-of-type.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TupleOfType=function TupleOfType(spec){return{check:target=>target instanceof Object&&spec.every((type,index)=>type.check(target[index])),toString:()=>`[${spec.map(type=>`${type}`).join(", ")}]`}}},"../check/undefined-type.ts":
/*!**********************************!*\
  !*** ../check/undefined-type.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UndefinedType={check:target=>void 0===target,toString:()=>"undefined"}},"../check/union-type.ts":
/*!******************************!*\
  !*** ../check/union-type.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_list_1=__webpack_require__(/*! ../immutable/immutable-list */"../immutable/immutable-list.ts");class UnionTypeBuilder{constructor(){this.types_=[]}addType(type){return this.types_.push(type),this}build(){return new UnionType(this.types_.slice())}}class UnionType{constructor(types){this.types_=types}check(target){return immutable_list_1.ImmutableList.of(this.types_).some(type=>type.check(target))}toString(){return`(${this.types_.map(type=>`${type}`).join(" | ")})`}static builder(){return new UnionTypeBuilder}}exports.UnionType=UnionType},"../data/a-serializable.ts":
/*!*********************************!*\
  !*** ../data/a-serializable.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_map_1=__webpack_require__(/*! ../immutable/immutable-map */"../immutable/immutable-map.ts"),__FIELDS=Symbol("fields"),__NAME=Symbol("name"),__PARENT=Symbol("parent"),TYPE_FIELD="_type",CTORS=new Map;function initField_(obj){obj[__FIELDS]||(obj[__FIELDS]=new Map)}class Serializer{static fromJSON(json){if(!json)return json;const ctor=CTORS.get(json[TYPE_FIELD]);if(ctor){const defaultInstance=new ctor;for(const[key,jsonKey]of Serializer.getFields_(ctor)){const jsonValue=json[jsonKey];void 0!==jsonValue&&(defaultInstance[key]=this.fromJSON(jsonValue))}return defaultInstance}if(json instanceof Array)return json.map(value=>this.fromJSON(value));if(json instanceof Object){const obj={};for(const key in json)obj[key]=this.fromJSON(json[key]);return obj}return json}static getFields_(ctor){return(ctor.prototype[__PARENT]?Serializer.getFields_(ctor.prototype[__PARENT]):immutable_map_1.ImmutableMap.of(new Map)).addAll(ctor.prototype[__FIELDS])}static getRegisteredCtor(serializedName){return CTORS.get(serializedName)||null}static getSerializedName(ctor){return ctor[__NAME]||null}static toJSON(obj){if(!(obj instanceof Object))return obj;const ctor=obj.constructor;if(ctor.prototype[__NAME]){const json={[TYPE_FIELD]:ctor.prototype[__NAME]};for(const[key,jsonKey]of Serializer.getFields_(ctor))json[jsonKey]=this.toJSON(obj[key]);return json}if(obj instanceof Array)return obj.map(value=>this.toJSON(value));{const json={};for(const key in obj)json[key]=this.toJSON(obj[key]);return json}}}exports.Serializer=Serializer,exports.Serializable=function Serializable(name,parent=null){return function(ctor){CTORS.set(name,ctor),initField_(ctor.prototype),ctor.prototype[__NAME]=name,null!==parent&&(ctor.prototype[__PARENT]=parent)}},exports.Field=function Field(name){return function(target,propertyKey){initField_(target),target[__FIELDS].set(propertyKey,name)}}},"../data/annotations.ts":
/*!******************************!*\
  !*** ../data/annotations.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_map_1=__webpack_require__(/*! ../immutable/immutable-map */"../immutable/immutable-map.ts"),immutable_set_1=__webpack_require__(/*! ../immutable/immutable-set */"../immutable/immutable-set.ts"),hash_1=__webpack_require__(/*! ../util/hash */"../util/hash.ts");class AnnotationsHandler{constructor(annotation,parent){this.annotation_=annotation,this.parent_=parent,this.propertyValues_=new Map}attachValueToProperty(key,value){let values=this.propertyValues_.get(key);values||(values=new Set,this.propertyValues_.set(key,values)),values.add(value)}getAnnotatedProperties(){return this.getAttachedValues().keys()}getAttachedValues(){const entries=[];for(const[key,values]of this.propertyValues_)entries.push([key,immutable_set_1.ImmutableSet.of(values)]);const fluentMappable=immutable_map_1.ImmutableMap.of(entries);if(null!==this.parent_){const parentAnnotationValues=AnnotationsHandler.of(this.annotation_,this.parent_).getAttachedValues();return fluentMappable.addAll(parentAnnotationValues)}return fluentMappable}static createHash_(ctor,annotation){return`${hash_1.hash(ctor)}_${hash_1.hash(annotation)}`}static hasAnnotation(ctor,annotation){return AnnotationsHandler.REGISTERED_ANNOTATIONS_.has(AnnotationsHandler.createHash_(ctor,annotation))}static of(annotation,ctor){const hash=AnnotationsHandler.createHash_(ctor,annotation),handler=AnnotationsHandler.REGISTERED_ANNOTATIONS_.get(hash);if(void 0!==handler)return handler;const parentProto=Object.getPrototypeOf(ctor.prototype),parent=null===parentProto?null:parentProto.constructor,newHandler=new AnnotationsHandler(annotation,parent);return AnnotationsHandler.REGISTERED_ANNOTATIONS_.set(hash,newHandler),newHandler}}AnnotationsHandler.REGISTERED_ANNOTATIONS_=new Map,exports.AnnotationsHandler=AnnotationsHandler;class Annotations{constructor(annotation){this.annotation_=annotation}forCtor(ctor){return AnnotationsHandler.of(this.annotation_,ctor)}hasAnnotation(ctor){return AnnotationsHandler.hasAnnotation(ctor,this.annotation_)}static of(annotation){return new Annotations(annotation)}}exports.Annotations=Annotations},"../data/cache.ts":
/*!************************!*\
  !*** ../data/cache.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const caches_1=__webpack_require__(/*! ../data/caches */"../data/caches.ts"),error_1=__webpack_require__(/*! ../error */"../error/index.ts"),hash_1=__webpack_require__(/*! ../util/hash */"../util/hash.ts");exports.cache=function cache(){return function(target,propertyKey,descriptor){const value=descriptor.value;if(!(value instanceof Function))throw error_1.Errors.assert("attached").shouldBeAnInstanceOf(Function).butWas(value);return descriptor.value=function(...args){const cache=caches_1.Caches.getCache(this,propertyKey),argsHash=args.map(arg=>hash_1.hash(arg)).join("_"),cachedValue=cache.get(argsHash);if(void 0!==cachedValue)return cachedValue;const result=value.apply(this,args);return caches_1.Caches.setCacheValue(this,propertyKey,argsHash,result),result},caches_1.CACHE_ANNOTATIONS.forCtor(target.constructor).attachValueToProperty(propertyKey,{}),descriptor}}},"../data/caches.ts":
/*!*************************!*\
  !*** ../data/caches.ts ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const annotations_1=__webpack_require__(/*! ../data/annotations */"../data/annotations.ts"),immutable_map_1=__webpack_require__(/*! ../immutable/immutable-map */"../immutable/immutable-map.ts"),__CACHES=Symbol("caches");exports.CACHE_ANNOTATIONS=annotations_1.Annotations.of(__CACHES);class Caches{static clear(instance,propertyKey){Caches.getCache_(instance,propertyKey).clear()}static clearAll(instance){for(const key of exports.CACHE_ANNOTATIONS.forCtor(instance.constructor).getAnnotatedProperties())Caches.clear(instance,key)}static getCache(instance,propertyKey){return immutable_map_1.ImmutableMap.of(Caches.getCache_(instance,propertyKey))}static getCache_(instance,propertyKey){const caches=Caches.getCaches(instance),value=caches.get(propertyKey);if(void 0!==value)return value;const cache=new Map;return caches.set(propertyKey,cache),cache}static getCaches(target){if(void 0!==target[__CACHES])return target[__CACHES];{const caches=new Map;return target[__CACHES]=caches,caches}}static setCacheValue(instance,propertyKey,key,value){Caches.getCache_(instance,propertyKey).set(key,value)}}exports.Caches=Caches},"../data/index.ts":
/*!************************!*\
  !*** ../data/index.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var annotations_1=__webpack_require__(/*! ./annotations */"../data/annotations.ts");exports.Annotations=annotations_1.Annotations;var a_serializable_1=__webpack_require__(/*! ./a-serializable */"../data/a-serializable.ts");exports.Field=a_serializable_1.Field,exports.Serializable=a_serializable_1.Serializable,exports.Serializer=a_serializable_1.Serializer;var cache_1=__webpack_require__(/*! ./cache */"../data/cache.ts");exports.cache=cache_1.cache;var jsons_1=__webpack_require__(/*! ./jsons */"../data/jsons.ts");exports.Jsons=jsons_1.Jsons},"../data/jsons.ts":
/*!************************!*\
  !*** ../data/jsons.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};Object.defineProperty(exports,"__esModule",{value:!0});const error_1=__webpack_require__(/*! ../error */"../error/index.ts"),deprecated_1=__webpack_require__(/*! ../typescript/deprecated */"../typescript/deprecated.ts"),LOG=__webpack_require__(/*! ../util/log */"../util/log.ts").Log.of("gs-tools.data.Jsons");class Jsons{static clone(original){const clone={};for(const key in original)clone[key]=original[key];return clone}static deepClone(original){return JSON.parse(JSON.stringify(original))}static getValue(json,path){const parts=path.split(".");let object=json;for(let i=0;i<parts.length&&object;i++)object=object[parts[i]];return object}static mixin(fromObj,toObj){for(const key in fromObj){const value=fromObj[key];void 0!==toObj[key]?"object"==typeof toObj[key]&&this.mixin(value,toObj[key]):toObj[key]=this.deepClone(value)}return toObj}static setValue(json,path,value){if(""===path)throw error_1.Errors.assert("path").should("not be empty").butWas(path);let object=json;const parts=path.split("."),propertyName=parts.pop();parts.forEach(part=>{void 0===object[part]&&(object[part]={}),object=object[part]}),object[propertyName]=value}}__decorate([deprecated_1.deprecated(LOG,"Use object spread instead")],Jsons,"mixin",null),exports.Jsons=Jsons},"../dispose/base-disposable.ts":
/*!*************************************!*\
  !*** ../dispose/base-disposable.ts ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TRACKED_DISPOSABLES=[],exports.Flags={enableTracking:!1};exports.BaseDisposable=class BaseDisposable{constructor(){this.disposables_=[],this.isDisposed_=!1,exports.Flags.enableTracking&&exports.TRACKED_DISPOSABLES.push(this)}addDisposable(...disposables){disposables.forEach(disposable=>{this.disposables_.push(disposable)})}dispose(){if(!this.isDisposed_){if(this.disposeInternal(),this.disposables_.forEach(disposable=>disposable.dispose()),exports.Flags.enableTracking){const index=exports.TRACKED_DISPOSABLES.indexOf(this);index>=0&&exports.TRACKED_DISPOSABLES.splice(index,1)}this.isDisposed_=!0}}disposeInternal(){}isDisposed(){return this.isDisposed_}}},"../dispose/disposable-function.ts":
/*!*****************************************!*\
  !*** ../dispose/disposable-function.ts ***!
  \*****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_disposable_1=__webpack_require__(/*! ../dispose/base-disposable */"../dispose/base-disposable.ts");class DisposableFunction extends base_disposable_1.BaseDisposable{constructor(fn){super(),this.fn_=fn}disposeInternal(){this.run()}run(){this.fn_()}static of(fn){return new DisposableFunction(fn)}}exports.DisposableFunction=DisposableFunction},"../dispose/index.ts":
/*!***************************!*\
  !*** ../dispose/index.ts ***!
  \***************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var base_disposable_1=__webpack_require__(/*! ./base-disposable */"../dispose/base-disposable.ts");exports.BaseDisposable=base_disposable_1.BaseDisposable;var disposable_function_1=__webpack_require__(/*! ./disposable-function */"../dispose/disposable-function.ts");exports.DisposableFunction=disposable_function_1.DisposableFunction},"../error/assertion-error.ts":
/*!***********************************!*\
  !*** ../error/assertion-error.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class AssertionShouldBuilder{constructor(fieldName_,condition_){this.fieldName_=fieldName_,this.condition_=condition_}butNot(){return this.createAssertionError_("not")}butWas(actual){return this.createAssertionError_(`was [${actual}]`)}createAssertionError_(but){return new AssertionError(`[${this.fieldName_}] should ${this.condition_}, but ${but}`)}}exports.AssertionShouldBuilder=AssertionShouldBuilder;exports.AssertionBuilder=class AssertionBuilder{constructor(fieldName_){this.fieldName_=fieldName_}should(condition){return new AssertionShouldBuilder(this.fieldName_,condition)}shouldBe(expected){return this.should(`be [${expected}]`)}shouldBeA(type){return this.should(`be a [${type}]`)}shouldBeAnInstanceOf(expected){return this.should(`be an instance of [${expected.name}]`)}shouldExist(){return this.should("exist")}};class AssertionError extends Error{constructor(message){super(`AssertionError: ${message}`),Object.setPrototypeOf(this,new.target.prototype)}}exports.AssertionError=AssertionError},"../error/errors.ts":
/*!**************************!*\
  !*** ../error/errors.ts ***!
  \**************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const assertion_error_1=__webpack_require__(/*! ../error/assertion-error */"../error/assertion-error.ts");exports.Errors={assert:fieldName=>new assertion_error_1.AssertionBuilder(fieldName)}},"../error/index.ts":
/*!*************************!*\
  !*** ../error/index.ts ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var errors_1=__webpack_require__(/*! ./errors */"../error/errors.ts");exports.Errors=errors_1.Errors},"../graph/debug.ts":
/*!*************************!*\
  !*** ../graph/debug.ts ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const data_1=__webpack_require__(/*! ../data */"../data/index.ts"),error_1=__webpack_require__(/*! ../error */"../error/index.ts"),graph_1=__webpack_require__(/*! ../graph/graph */"../graph/graph.ts"),immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts");exports.Debug={trace(id,context){const node=graph_1.Graph.getNode_(id);if(!node)throw error_1.Errors.assert(`Node for [${id}]`).shouldExist().butWas(node);const valueMap=new Map;for(const[time,value]of node.getCache_(context))valueMap.set(time.value_(),value);const parameters=node.getParameterIds().map(id=>exports.Debug.trace(id,context));return new class DebugNode{constructor(id,values,parameters){this.id=id,this.values=values,this.parameters=parameters}}(id,immutable_1.ImmutableMap.of(valueMap),parameters)}},data_1.Jsons.setValue(window,"gs.tools.Graph.Debug",exports.Debug)},"../graph/flags.ts":
/*!*************************!*\
  !*** ../graph/flags.ts ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FLAGS={checkValueType:!0}},"../graph/g-node.ts":
/*!**************************!*\
  !*** ../graph/g-node.ts ***!
  \**************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const dispose_1=__webpack_require__(/*! ../dispose */"../dispose/index.ts"),error_1=__webpack_require__(/*! ../error */"../error/index.ts"),immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts");exports.GLOBALS=new dispose_1.BaseDisposable;exports.GNode=class GNode{constructor(parameterIds_){this.parameterIds_=parameterIds_,this.cacheMap_=new Map}addToCache_(context,timestamp,value){const cache=this.getCache_(context);if(cache.has(timestamp))throw error_1.Errors.assert("cache").should(`have timestamp ${timestamp}`).butWas(cache);cache.set(timestamp,value)}execute(context,params,timestamp){const normalizedContext=context||exports.GLOBALS,cachedValue=this.getCache_(normalizedContext).get(timestamp);if(void 0!==cachedValue)return cachedValue;const value=this.execute_(normalizedContext,params);return this.addToCache_(normalizedContext,timestamp,value),value}getCache_(context){const map=this.cacheMap_.get(context);if(map)return map;const cache=new Map;return this.cacheMap_.set(context,cache),cache}getLatestCacheValue(context,timestamp){const cache=this.cacheMap_.get(context||exports.GLOBALS);return cache?immutable_1.ImmutableMap.of(cache).filter((_,time)=>time.beforeOrEqualTo(timestamp)).reduce((prev,value,key)=>prev?prev[0].beforeOrEqualTo(key)?[key,value]:prev:[key,value],null):null}getParameterIds(){return this.parameterIds_}}},"../graph/graph-event-handler.ts":
/*!***************************************!*\
  !*** ../graph/graph-event-handler.ts ***!
  \***************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const dispose_1=__webpack_require__(/*! ../dispose */"../dispose/index.ts"),g_node_1=__webpack_require__(/*! ../graph/g-node */"../graph/g-node.ts");exports.GraphEventHandler=class GraphEventHandler extends dispose_1.BaseDisposable{constructor(){super(...arguments),this.onChangeListeners_=new WeakMap,this.onReadyListeners_=new WeakMap}callHandlers_(listeners,context,id,type){const handlers=this.getHandlers_(listeners,context,id)||new Set,event={context:context,id:id,type:type};for(const handler of handlers)handler(event)}dispatchChange(id,context=g_node_1.GLOBALS){this.callHandlers_(this.onChangeListeners_,context,id,"change")}dispatchReady(id,context=g_node_1.GLOBALS){this.callHandlers_(this.onReadyListeners_,context,id,"ready")}getHandlers_(listeners,context,id){const map=listeners.get(context);return map&&map.get(id)||null}modifyHandlers_(listeners,context,id,fn){const map=listeners.get(context)||new Map,handlers=map.get(id)||new Set;fn(handlers),handlers.size>0?map.set(id,handlers):map.delete(id),map.size>0?listeners.set(context,map):listeners.delete(context)}onChange(id,handler,context=g_node_1.GLOBALS){return this.modifyHandlers_(this.onChangeListeners_,context,id,handlers=>handlers.add(handler)),dispose_1.DisposableFunction.of(()=>{this.modifyHandlers_(this.onChangeListeners_,context,id,handlers=>handlers.delete(handler))})}onReady(id,handler,context=g_node_1.GLOBALS){return this.modifyHandlers_(this.onReadyListeners_,context,id,handlers=>handlers.add(handler)),dispose_1.DisposableFunction.of(()=>{this.modifyHandlers_(this.onReadyListeners_,context,id,handlers=>handlers.delete(handler))})}}},"../graph/graph-time-node.ts":
/*!***********************************!*\
  !*** ../graph/graph-time-node.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const g_node_1=__webpack_require__(/*! ../graph/g-node */"../graph/g-node.ts"),immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts");exports.GraphTimeNode=class GraphTimeNode extends g_node_1.GNode{constructor(){super(immutable_1.ImmutableList.of([]))}execute(_context,_params,timestamp){return timestamp}execute_(){throw new Error("Method not implemented.")}}},"../graph/graph-time.ts":
/*!******************************!*\
  !*** ../graph/graph-time.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const check_1=__webpack_require__(/*! ../check */"../check/index.ts"),static_id_1=__webpack_require__(/*! ../graph/static-id */"../graph/static-id.ts");class GraphTime{constructor(timestamp_){this.timestamp_=timestamp_}before(other){return this.timestamp_<other.timestamp_}beforeOrEqualTo(other){return this.timestamp_<=other.timestamp_}increment(){return new GraphTime(this.timestamp_+1)}toString(){return`GraphTime(${this.timestamp_})`}value_(){return this.timestamp_}static new(){return new GraphTime(0)}}exports.GraphTime=GraphTime,exports.$time=static_id_1.staticId("time",check_1.InstanceofType(GraphTime))},"../graph/graph.ts":
/*!*************************!*\
  !*** ../graph/graph.ts ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const dispose_1=__webpack_require__(/*! ../dispose */"../dispose/index.ts"),error_1=__webpack_require__(/*! ../error */"../error/index.ts"),flags_1=__webpack_require__(/*! ../graph/flags */"../graph/flags.ts"),g_node_1=__webpack_require__(/*! ../graph/g-node */"../graph/g-node.ts"),graph_event_handler_1=__webpack_require__(/*! ../graph/graph-event-handler */"../graph/graph-event-handler.ts"),graph_time_1=__webpack_require__(/*! ../graph/graph-time */"../graph/graph-time.ts"),graph_time_node_1=__webpack_require__(/*! ../graph/graph-time-node */"../graph/graph-time-node.ts"),inner_node_1=__webpack_require__(/*! ../graph/inner-node */"../graph/inner-node.ts"),input_node_1=__webpack_require__(/*! ../graph/input-node */"../graph/input-node.ts"),instance_id_1=__webpack_require__(/*! ../graph/instance-id */"../graph/instance-id.ts"),static_id_1=__webpack_require__(/*! ../graph/static-id */"../graph/static-id.ts"),immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts"),typescript_1=__webpack_require__(/*! ../typescript */"../typescript/index.ts"),util_1=__webpack_require__(/*! ../util */"../util/index.ts"),LOGGER=util_1.Log.of("gs-tools.graph.Graph");class GraphImpl extends dispose_1.BaseDisposable{constructor(){super(),this.currentTime_=graph_time_1.GraphTime.new(),this.monitoredNodes_=new WeakMap,this.nodes_=new Map([[graph_time_1.$time,new graph_time_node_1.GraphTimeNode]]),this.setQueue_=[],this.transitiveDependencies_=new Map,this.eventHandler_=new graph_event_handler_1.GraphEventHandler,this.addDisposable(this.eventHandler_)}assertNodeExist_(nodeId){this.getNode_(nodeId)}createProvider(nodeId,initValue){if(this.nodes_.has(nodeId))throw new Error(`Node ${nodeId} is already registered`);const node=new input_node_1.InputNode(initValue);return this.nodes_.set(nodeId,node),nodeId instanceof static_id_1.StaticId?newValue=>this.set_(nodeId,g_node_1.GLOBALS,newValue):(newValue,context)=>this.set_(nodeId,context,newValue)}get(nodeId,timestamp,context=g_node_1.GLOBALS){return __awaiter(this,void 0,void 0,function*(){util_1.Log.debug(LOGGER,`getting: ${nodeId}`);const idealExecutionTime=nodeId instanceof static_id_1.StaticId?this.getIdealExecutionTime_(nodeId,timestamp):this.getIdealExecutionTime_(nodeId,timestamp,context),node=this.getNode_(nodeId),latestCacheValue=node.getLatestCacheValue(context,idealExecutionTime),parameters=yield Promise.all(node.getParameterIds().map(parameterId=>parameterId instanceof static_id_1.StaticId?this.get(parameterId,idealExecutionTime):this.get(parameterId,idealExecutionTime,context)));if(node instanceof inner_node_1.InnerNode&&!this.isMonitored_(context,nodeId)){for(const dependencyId of this.getTransitiveDependencies_(nodeId)){const handler=()=>this.onReady_(nodeId,context);dependencyId instanceof static_id_1.StaticId?this.addDisposable(this.eventHandler_.onReady(dependencyId,handler)):this.addDisposable(this.eventHandler_.onReady(dependencyId,handler,context))}const ids=this.monitoredNodes_.get(context)||immutable_1.ImmutableSet.of([]);this.monitoredNodes_.set(context,ids.add(nodeId))}util_1.Log.debug(LOGGER,`executing: ${nodeId}`);const value=node.execute(context,parameters,idealExecutionTime),cachedValue=latestCacheValue?latestCacheValue[1]:null,[resolvedCached,resolvedValue]=yield Promise.all([cachedValue,value]);if(flags_1.FLAGS.checkValueType&&!nodeId.getType().check(resolvedValue))throw new Error(`Node for ${nodeId} returns the incorrect type. [${resolvedValue}]`);return typescript_1.equals(resolvedCached,resolvedValue)||(nodeId instanceof instance_id_1.InstanceId?this.eventHandler_.dispatchChange(nodeId,context):this.eventHandler_.dispatchChange(nodeId)),util_1.Log.debug(LOGGER,`executed: ${nodeId} ${resolvedValue}`),resolvedValue})}getAll(timestamp,context,...nodeIds){return __awaiter(this,void 0,void 0,function*(){return Promise.all(nodeIds.map(nodeId=>nodeId instanceof static_id_1.StaticId?this.get(nodeId,timestamp):this.get(nodeId,timestamp,context)))})}getIdealExecutionTime_(nodeId,timestamp,context=g_node_1.GLOBALS){const node=this.getNode_(nodeId),parameterIds=node.getParameterIds();if(0===parameterIds.size()){const entry=node.getLatestCacheValue(context,timestamp);return entry?entry[0]:this.currentTime_}const times=parameterIds.map(id=>id instanceof static_id_1.StaticId?this.getIdealExecutionTime_(id,timestamp):this.getIdealExecutionTime_(id,timestamp,context));return times.reduce((prev,current)=>prev.beforeOrEqualTo(current)?current:prev,times.getAt(0))}getNode_(nodeId){const node=this.nodes_.get(nodeId);if(!node)throw error_1.Errors.assert(`Node [${nodeId}]`).shouldExist().butWas(node);return node}getTimestamp(){return this.currentTime_}getTransitiveDependencies_(nodeId){const existingDependencies=this.transitiveDependencies_.get(nodeId);if(existingDependencies)return existingDependencies;const node=this.nodes_.get(nodeId);if(!node)throw error_1.Errors.assert(`Node for [${nodeId}]`).shouldExist().butNot();const dependencies=new Set;for(const paramId of node.getParameterIds()){dependencies.add(paramId);for(const dependency of this.getTransitiveDependencies_(paramId))dependencies.add(dependency)}const deps=immutable_1.ImmutableSet.of(dependencies);return this.transitiveDependencies_.set(nodeId,deps),deps}isMonitored_(context,nodeId){const ids=this.monitoredNodes_.get(context);return!!ids&&ids.has(nodeId)}isRegistered(id){return this.nodes_.has(id)}onChange(id,handler,context){return id instanceof static_id_1.StaticId?this.eventHandler_.onChange(id,handler):this.eventHandler_.onChange(id,handler,context)}onReady(context,id,handler){return id instanceof static_id_1.StaticId?this.eventHandler_.onReady(id,handler):this.eventHandler_.onReady(id,handler,context)}onReady_(nodeId,context){nodeId instanceof static_id_1.StaticId?this.refresh(nodeId):this.refresh(nodeId,context)}processSetQueue_(){return __awaiter(this,void 0,void 0,function*(){const promises=this.setQueue_.map(setFn=>new Promise(resolve=>{window.setTimeout(()=>{setFn(),resolve()},0)}));this.setQueue_.splice(0,this.setQueue_.length),yield Promise.all(promises)})}refresh(nodeId,context=g_node_1.GLOBALS){this.assertNodeExist_(nodeId),nodeId instanceof static_id_1.StaticId?this.eventHandler_.dispatchReady(nodeId):this.eventHandler_.dispatchReady(nodeId,context)}registerGenericProvider_(nodeId,provider,...args){const existingNode=this.nodes_.get(nodeId);if(existingNode){if(!(existingNode instanceof inner_node_1.InnerNode))throw error_1.Errors.assert(`Node for [${nodeId}]`).should("not be registered").butNot();if(existingNode.getProvider().toString()!==provider.toString())throw error_1.Errors.assert(`reregistered node provider for ${nodeId}`).shouldBe(existingNode.getProvider()).butWas(provider);const existingArgs=existingNode.getParameterIds(),newArgs=immutable_1.ImmutableList.of(args),maxIndex=Math.max(existingArgs.size(),newArgs.size());for(let i=0;i<maxIndex;i++){const existingArg=existingArgs.getAt(i);if(existingArg!==newArgs.getAt(i))throw error_1.Errors.assert(`reregistered node parameter ${i} for ${nodeId}`).shouldBe(existingArg).butNot()}return}const node=new inner_node_1.InnerNode(provider,immutable_1.ImmutableList.of(args));this.nodes_.set(nodeId,node)}registerProvider(nodeId,provider,...args){this.registerGenericProvider_(nodeId,provider,...args)}set_(nodeId,context,value){util_1.Log.debug(LOGGER,`setting: ${nodeId} ${value}`);const node=this.nodes_.get(nodeId);if(!(node instanceof input_node_1.InputNode))throw error_1.Errors.assert(`Node ${nodeId}`).shouldBeAnInstanceOf(input_node_1.InputNode).butWas(node);const promise=new Promise(resolve=>{this.setQueue_.push(()=>{util_1.Log.debug(LOGGER,`set flush: ${nodeId} ${value}`);const newTime=this.currentTime_.increment();node.set(context,newTime,value),this.currentTime_=newTime,nodeId instanceof static_id_1.StaticId?(this.refresh(nodeId),this.eventHandler_.dispatchChange(nodeId)):(this.refresh(nodeId,context),this.eventHandler_.dispatchChange(nodeId,context)),resolve()})});return setTimeout(()=>this.processSetQueue_(),0),promise}toString(){return"Graph"}}exports.GraphImpl=GraphImpl,exports.Graph=new GraphImpl},"../graph/index.ts":
/*!*************************!*\
  !*** ../graph/index.ts ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var debug_1=__webpack_require__(/*! ./debug */"../graph/debug.ts");exports.Debug=debug_1.Debug;var flags_1=__webpack_require__(/*! ./flags */"../graph/flags.ts");exports.FLAGS=flags_1.FLAGS;var graph_1=__webpack_require__(/*! ./graph */"../graph/graph.ts");exports.Graph=graph_1.Graph;var graph_time_1=__webpack_require__(/*! ./graph-time */"../graph/graph-time.ts");exports.$time=graph_time_1.$time,exports.GraphTime=graph_time_1.GraphTime;var instance_id_1=__webpack_require__(/*! ./instance-id */"../graph/instance-id.ts");exports.instanceId=instance_id_1.instanceId,exports.InstanceId=instance_id_1.InstanceId;var node_in_1=__webpack_require__(/*! ./node-in */"../graph/node-in.ts");exports.nodeIn=node_in_1.nodeIn;var node_out_1=__webpack_require__(/*! ./node-out */"../graph/node-out.ts");exports.nodeOut=node_out_1.nodeOut;var static_id_1=__webpack_require__(/*! ./static-id */"../graph/static-id.ts");exports.staticId=static_id_1.staticId,exports.StaticId=static_id_1.StaticId;var test_graph_1=__webpack_require__(/*! ./test-graph */"../graph/test-graph.ts");exports.TestGraph=test_graph_1.TestGraph},"../graph/inner-node.ts":
/*!******************************!*\
  !*** ../graph/inner-node.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const g_node_1=__webpack_require__(/*! ../graph/g-node */"../graph/g-node.ts");exports.InnerNode=class InnerNode extends g_node_1.GNode{constructor(fn_,parameterIds_){super(parameterIds_),this.fn_=fn_}execute_(context,params){return this.fn_.apply(context,[...params])}getProvider(){return this.fn_}}},"../graph/input-node.ts":
/*!******************************!*\
  !*** ../graph/input-node.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const g_node_1=__webpack_require__(/*! ../graph/g-node */"../graph/g-node.ts"),immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts");exports.InputNode=class InputNode extends g_node_1.GNode{constructor(initValue_){super(immutable_1.ImmutableList.of([])),this.initValue_=initValue_,this.symbol_=Symbol("inputNode")}execute_(context){const value=context[this.symbol_];return void 0===value?this.initValue_:value}set(context,timestamp,value){const normalizedContext=context||g_node_1.GLOBALS;this.set_(normalizedContext,value),this.addToCache_(normalizedContext,timestamp,value)}set_(context,value){context[this.symbol_]=value}}},"../graph/instance-id.ts":
/*!*******************************!*\
  !*** ../graph/instance-id.ts ***!
  \*******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class InstanceId{constructor(debug_,type_){this.debug_=debug_,this.type_=type_}getType(){return this.type_}toString(){return`InstanceId(${this.debug_})`}}exports.InstanceId=InstanceId,exports.instanceId=function instanceId(debug,type){return new InstanceId(debug,type)}},"../graph/node-in.ts":
/*!***************************!*\
  !*** ../graph/node-in.ts ***!
  \***************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const data_1=__webpack_require__(/*! ../data */"../data/index.ts");exports.ANNOTATIONS=data_1.Annotations.of(Symbol("nodeIn")),exports.nodeIn=function nodeIn(id){return(target,propertyKey,index)=>{exports.ANNOTATIONS.forCtor(target.constructor).attachValueToProperty(propertyKey,{index:index,id:id})}}},"../graph/node-out.ts":
/*!****************************!*\
  !*** ../graph/node-out.ts ***!
  \****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const graph_1=__webpack_require__(/*! ../graph */"../graph/index.ts"),node_in_1=__webpack_require__(/*! ../graph/node-in */"../graph/node-in.ts");exports.nodeOut=function nodeOut(instanceId){return(target,propertyKey)=>{const paramsSet=node_in_1.ANNOTATIONS.forCtor(target.constructor).getAttachedValues().get(propertyKey),paramsArray=[];for(const{index:index,id:id}of paramsSet||[])paramsArray[index]=id;graph_1.Graph.registerGenericProvider_(instanceId,target[propertyKey],...paramsArray)}}},"../graph/static-id.ts":
/*!*****************************!*\
  !*** ../graph/static-id.ts ***!
  \*****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class StaticId{constructor(debug_,type_){this.debug_=debug_,this.type_=type_}getType(){return this.type_}toString(){return`StaticId(${this.debug_})`}}exports.StaticId=StaticId,exports.staticId=function staticId(debug,type){return new StaticId(debug,type)}},"../graph/test-graph.ts":
/*!******************************!*\
  !*** ../graph/test-graph.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const flags_1=__webpack_require__(/*! ../graph/flags */"../graph/flags.ts"),graph_1=__webpack_require__(/*! ../graph/graph */"../graph/graph.ts"),static_id_1=__webpack_require__(/*! ../graph/static-id */"../graph/static-id.ts"),originalMap=new Map;let originalCheckValueType=!1;exports.TestGraph={afterEach(){graph_1.Graph.nodes_.clear();for(const[key,node]of originalMap)graph_1.Graph.nodes_.set(key,node);flags_1.FLAGS.checkValueType=originalCheckValueType,graph_1.Graph.setQueue_.splice(0,graph_1.Graph.setQueue_.length);for(const disposable of graph_1.Graph.disposables_)disposable.dispose()},beforeEach(){originalCheckValueType=flags_1.FLAGS.checkValueType,originalMap.clear();for(const[key,node]of graph_1.Graph.nodes_)originalMap.set(key,node)},clear(...nodeIds){for(const nodeId of nodeIds)graph_1.Graph.nodes_.delete(nodeId)},init(){},set(nodeId,initValue){flags_1.FLAGS.checkValueType=!1,exports.TestGraph.clear(nodeId),static_id_1.StaticId,graph_1.Graph.createProvider(nodeId,initValue)}}},"../immutable/generators.ts":
/*!**********************************!*\
  !*** ../immutable/generators.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.Generators=class Generators{static*ranged(from,step,to){if(from>to)throw new Error(`${from} must be <= ${to}`);for(let i=from;i<to;i+=step)yield i}}},"../immutable/immutable-list.ts":
/*!**************************************!*\
  !*** ../immutable/immutable-list.ts ***!
  \**************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const check_1=__webpack_require__(/*! ../check */"../check/index.ts"),error_1=__webpack_require__(/*! ../error */"../error/index.ts"),orderings_1=__webpack_require__(/*! ../immutable/orderings */"../immutable/orderings.ts"),typescript_1=__webpack_require__(/*! ../typescript */"../typescript/index.ts");class ImmutableList{constructor(data){this.data_=data.slice(0)}[Symbol.iterator](){return this.data_[Symbol.iterator]()}add(item){const clone=this.data_.slice(0);return clone.push(item),new ImmutableList(clone)}addAll(items){const clone=this.data_.slice(0);for(const item of items)clone.push(item);return new ImmutableList(clone)}delete(item){const clone=this.data_.slice(0),index=clone.indexOf(item);return index<0?this:(clone.splice(index,1),new ImmutableList(clone))}deleteAll(items){const clone=this.data_.slice(0);for(const item of items){const index=clone.indexOf(item);index>=0&&clone.splice(index,1)}return new ImmutableList(clone)}deleteAllKeys(keys){const toDeleteIndexes=[];for(const key of keys)toDeleteIndexes.push(key);toDeleteIndexes.sort((index1,index2)=>index1>index2?1:index1<index2?-1:0);const clone=this.data_.slice(0);for(const index of toDeleteIndexes.reverse())clone.splice(index,1);return new ImmutableList(clone)}deleteAt(index){return this.deleteKey(index)}deleteKey(key){const clone=this.data_.slice(0);return clone.splice(key,1),new ImmutableList(clone)}entries(){const clone=this.data_.map((value,index)=>[index,value]);return new ImmutableList(clone)}equals(other){if(this.size()!==other.size())return!1;for(let i=0;i<this.size();i++)if(this.getAt(i)!==other.getAt(i))return!1;return!0}every(check){for(const[key,value]of this.entries())if(!check(value,key))return!1;return!0}everyItem(check){return this.every(value=>check(value))}filter(checker){return new ImmutableList(this.data_.filter(checker))}filterByType(checker){const newItems=[];for(const item of this)checker.check(item)&&newItems.push(item);return ImmutableList.of(newItems)}filterItem(checker){return this.filter((value,_)=>checker(value))}find(check){return this.findValue(check)}findEntry(checker){for(const[index,value]of this.entries())if(checker(value,index))return[index,value];return null}findKey(checker){const entry=this.findEntry(checker);return null===entry?null:entry[0]}findValue(checker){const entry=this.findEntry(checker);return null===entry?null:entry[1]}get(index){return this.data_[index]}getAt(index){const normalizedIndex=index<0?index+this.size():index;return this.get(normalizedIndex)}has(item){return this.data_.indexOf(item)>=0}hasKey(key){return void 0!==this.data_[key]}insertAllAt(index,items){const toAdds=[];for(const toAdd of items)toAdds.push(toAdd);const clone=this.data_.slice(0);return clone.splice(index,0,...toAdds),new ImmutableList(clone)}insertAt(index,item){const clone=this.data_.slice(0);return clone.splice(index,0,item),new ImmutableList(clone)}keys(){return new ImmutableList(this.data_.map((_,index)=>index))}map(fn){return new ImmutableList(this.data_.map(fn))}mapItem(fn){return this.map((value,_)=>fn(value))}max(ordering){return this.reduceItem((prevValue,value)=>null===prevValue?value:-1===ordering(prevValue,value)?value:prevValue,null)}min(ordering){return this.max(orderings_1.Orderings.reverse(ordering))}reduce(fn,init){return this.data_.reduce(fn,init)}reduceItem(fn,init){return this.reduce((prev,value)=>fn(prev,value),init)}reverse(){return new ImmutableList(this.data_.reverse())}set(index,item){const clone=this.data_.slice(0);return clone[index]=item,new ImmutableList(clone)}setAt(index,item){return this.set(index,item)}size(){return this.data_.length}slice(start,end,step=1){if(0===step)throw error_1.Errors.assert("step").shouldBe("not 0").butWas(step);let normalizedEnd,normalizedStart;normalizedEnd=void 0===end?step>0?this.data_.length:-1:end<0?end+this.data_.length:end,normalizedStart=void 0!==start?start:step>0?0:this.data_.length-1;const sliceData=[];let loopBound;loopBound=step>0?Math.min(this.data_.length,normalizedEnd):Math.max(-1,normalizedEnd);for(let i=normalizedStart;step<0?i>loopBound:i<loopBound;i+=step)sliceData.push(this.data_[i]);return new ImmutableList(sliceData)}some(check){for(const[key,value]of this.entries())if(check(value,key))return!0;return!1}someItem(check){return this.some(value=>check(value))}sort(compareFn){const clone=this.data_.slice(0);return new ImmutableList(clone.sort(compareFn))}toString(){return`[${[...this.mapItem(item=>`${item}`)].join(", ")}]`}values(){return this}static of(data){if(check_1.FiniteIterableType.check(data))return new ImmutableList([...data]);if(function ItemListType(){return check_1.IntersectType.builder().addType(check_1.HasPropertyType("item",check_1.InstanceofType(Function))).addType(check_1.HasPropertyType("length",check_1.NumberType)).build()}().check(data)){const array=[];for(let i=0;i<data.length;i++)array.push(data.item(i));return new ImmutableList(array)}if(data instanceof DataTransferItemList){const array=[];for(let i=0;i<data.length;i++)array.push(data[i]);return new ImmutableList(array)}if(data instanceof Array)return new ImmutableList(data);throw typescript_1.assertUnreachable(data)}}exports.ImmutableList=ImmutableList},"../immutable/immutable-map.ts":
/*!*************************************!*\
  !*** ../immutable/immutable-map.ts ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const check_1=__webpack_require__(/*! ../check */"../check/index.ts"),immutable_set_1=__webpack_require__(/*! ./immutable-set */"../immutable/immutable-set.ts"),ordered_map_1=__webpack_require__(/*! ./ordered-map */"../immutable/ordered-map.ts"),orderings_1=__webpack_require__(/*! ./orderings */"../immutable/orderings.ts");class ImmutableMap{constructor(data){this.data_=new Map(data)}[Symbol.iterator](){return this.data_[Symbol.iterator]()}add([key,value]){return this.set(key,value)}addAll(items){const clone=new Map(this.data_);for(const[key,value]of items)clone.set(key,value);return new ImmutableMap(clone)}delete([key,_]){const clone=new Map(this.data_);return clone.delete(key),new ImmutableMap(clone)}deleteAll(items){const clone=new Map(this.data_);for(const[key,_]of items)clone.delete(key);return new ImmutableMap(clone)}deleteAllKeys(keys){const clone=new Map(this.data_);for(const key of keys)clone.delete(key);return new ImmutableMap(clone)}deleteKey(key){const clone=new Map(this.data_);return clone.delete(key),new ImmutableMap(clone)}entries(){return immutable_set_1.ImmutableSet.of(this)}every(check){return this.everyItem(([key,value])=>check(value,key))}everyItem(check){for(const entry of this)if(!check(entry))return!1;return!0}filter(checker){return this.filterItem(([key,value])=>checker(value,key))}filterByType(checker){const newItems=[];for(const item of this)checker.check(item)&&newItems.push(item);return immutable_set_1.ImmutableSet.of(newItems)}filterItem(checker){return ImmutableMap.of(this.entries().filterItem(checker))}find(check){return this.findEntry((value,index)=>check([index,value]))}findEntry(checker){for(const[index,value]of this.entries())if(checker(value,index))return[index,value];return null}findKey(checker){const entry=this.findEntry(checker);return null===entry?null:entry[0]}findValue(checker){const entry=this.findEntry(checker);return null===entry?null:entry[1]}get(index){return this.data_.get(index)}has([key,value]){return this.data_.get(key)===value}hasKey(key){return this.data_.has(key)}keys(){return this.entries().mapItem(([key,_])=>key)}map(fn){const mappedEntries=this.entries().mapItem(([key,value])=>[key,fn(value,key)]);return ImmutableMap.of(mappedEntries)}mapItem(fn){const mappedEntries=this.entries().mapItem(([key,value])=>fn([key,value]));return immutable_set_1.ImmutableSet.of(mappedEntries)}max(ordering){return this.reduceItem((prevValue,currentEntry)=>null===prevValue?currentEntry:-1===ordering(prevValue,currentEntry)?currentEntry:prevValue,null)}min(ordering){return this.max(orderings_1.Orderings.reverse(ordering))}reduce(fn,init){let result=init;for(const[key,value]of this.data_)result=fn(result,value,key);return result}reduceItem(fn,init){return this.reduce((prevValue,value,key)=>fn(prevValue,[key,value]),init)}set(key,item){const clone=new Map(this.data_);return clone.set(key,item),new ImmutableMap(clone)}setForTest(key,value){this.data_.set(key,value)}size(){return this.data_.size}some(check){return this.someItem(([key,value])=>check(value,key))}someItem(check){for(const entry of this)if(check(entry))return!0;return!1}sort(ordering){return ordered_map_1.OrderedMap.of([...this.entries().sort(ordering)])}values(){return this.entries().mapItem(([_,value])=>value)}static of(data){if(check_1.FiniteIterableType.check(data))return new ImmutableMap(new Map(data));if(check_1.InstanceofType(Array).check(data))return new ImmutableMap(new Map(data));if(data instanceof Map)return new ImmutableMap(new Map(data));{const entries=[];for(const key in data)entries.push([key,data[key]]);return new ImmutableMap(new Map(entries))}}}exports.ImmutableMap=ImmutableMap},"../immutable/immutable-set.ts":
/*!*************************************!*\
  !*** ../immutable/immutable-set.ts ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const finite_iterable_type_1=__webpack_require__(/*! ../check/finite-iterable-type */"../check/finite-iterable-type.ts"),instanceof_type_1=__webpack_require__(/*! ../check/instanceof-type */"../check/instanceof-type.ts"),iterables_1=__webpack_require__(/*! ../immutable/iterables */"../immutable/iterables.ts"),ordered_set_1=__webpack_require__(/*! ../immutable/ordered-set */"../immutable/ordered-set.ts"),orderings_1=__webpack_require__(/*! ../immutable/orderings */"../immutable/orderings.ts"),assert_unreachable_1=__webpack_require__(/*! ../typescript/assert-unreachable */"../typescript/assert-unreachable.ts");class ImmutableSet{constructor(data){this.data_=new Set(iterables_1.Iterables.clone(data))}[Symbol.iterator](){return this.data_[Symbol.iterator]()}add(item){const clone=new Set(iterables_1.Iterables.clone(this.data_));return clone.add(item),new ImmutableSet(clone)}addAll(items){const clone=new Set(iterables_1.Iterables.clone(this.data_));for(const item of items)clone.add(item);return new ImmutableSet(clone)}delete(item){const clone=new Set(iterables_1.Iterables.clone(this.data_));return clone.delete(item),new ImmutableSet(clone)}deleteAll(items){const clone=new Set(iterables_1.Iterables.clone(this.data_));for(const item of items)clone.delete(item);return new ImmutableSet(clone)}everyItem(check){for(const item of this)if(!check(item))return!1;return!0}filterByType(checker){const newItems=[];for(const item of this)checker.check(item)&&newItems.push(item);return ImmutableSet.of(newItems)}filterItem(checker){const iterable=this;return new ImmutableSet(new Set(iterables_1.Iterables.of(function*(){for(const item of iterable)checker(item)&&(yield item)})))}find(check){for(const item of this.data_)if(check(item))return item;return null}has(item){return this.data_.has(item)}mapItem(fn){const iterable=this;return new ImmutableSet(new Set(iterables_1.Iterables.of(function*(){for(const item of iterable)yield fn(item)})))}max(ordering){return this.reduceItem((prevValue,value)=>null===prevValue?value:-1===ordering(prevValue,value)?value:prevValue,null)}min(ordering){return this.max(orderings_1.Orderings.reverse(ordering))}reduceItem(fn,init){let result=init;for(const item of this.data_)result=fn(result,item);return result}size(){return this.data_.size}someItem(check){for(const item of this)if(check(item))return!0;return!1}sort(compareFn){const arrayData=Array.from(this.data_);return ordered_set_1.OrderedSet.of(arrayData.sort(compareFn))}static of(data){if(instanceof_type_1.InstanceofType(Set).check(data))return new ImmutableSet(data);if(instanceof_type_1.InstanceofType(Array).check(data))return new ImmutableSet(new Set(data));if(finite_iterable_type_1.FiniteIterableType.check(data))return new ImmutableSet(new Set(data));throw assert_unreachable_1.assertUnreachable(data)}}exports.ImmutableSet=ImmutableSet},"../immutable/index.ts":
/*!*****************************!*\
  !*** ../immutable/index.ts ***!
  \*****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var generators_1=__webpack_require__(/*! ./generators */"../immutable/generators.ts");exports.Generators=generators_1.Generators;var immutable_list_1=__webpack_require__(/*! ./immutable-list */"../immutable/immutable-list.ts");exports.ImmutableList=immutable_list_1.ImmutableList;var immutable_map_1=__webpack_require__(/*! ./immutable-map */"../immutable/immutable-map.ts");exports.ImmutableMap=immutable_map_1.ImmutableMap;var immutable_set_1=__webpack_require__(/*! ./immutable-set */"../immutable/immutable-set.ts");exports.ImmutableSet=immutable_set_1.ImmutableSet;var iterables_1=__webpack_require__(/*! ./iterables */"../immutable/iterables.ts");exports.Iterables=iterables_1.Iterables;var ordered_map_1=__webpack_require__(/*! ./ordered-map */"../immutable/ordered-map.ts");exports.OrderedMap=ordered_map_1.OrderedMap;var orderings_1=__webpack_require__(/*! ./orderings */"../immutable/orderings.ts");exports.Orderings=orderings_1.Orderings;var tree_map_1=__webpack_require__(/*! ./tree-map */"../immutable/tree-map.ts");exports.TreeMap=tree_map_1.TreeMap;var tree_set_1=__webpack_require__(/*! ./tree-set */"../immutable/tree-set.ts");exports.TreeSet=tree_set_1.TreeSet;var vector2d_1=__webpack_require__(/*! ./vector2d */"../immutable/vector2d.ts");exports.Vector2d=vector2d_1.Vector2d},"../immutable/iterables.ts":
/*!*********************************!*\
  !*** ../immutable/iterables.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const check_1=__webpack_require__(/*! ../check */"../check/index.ts"),typescript_1=__webpack_require__(/*! ../typescript */"../typescript/index.ts");class Iterables{static clone(iterable){return{*[Symbol.iterator](){for(const value of iterable)yield value}}}static flatten(iterables){const output=[];for(const iterable of iterables)for(const item of iterable)output.push(item);return output}static of(data){if(Iterables.ITERATOR_TYPE.check(data))return{[Symbol.iterator]:()=>data};if(data instanceof Function)return Iterables.of(data());throw typescript_1.assertUnreachable(data)}static unsafeEquals(iterable1,iterable2){const array1=[...iterable1],array2=[...iterable2];if(array1.length!==array2.length)return!1;for(let i=0;i<array1.length;i++){const item1=array1[i],item2=array2[i];if((!check_1.IterableType.check(item1)||check_1.StringType.check(item1)||!check_1.IterableType.check(item2)||check_1.StringType.check(item2)||!Iterables.unsafeEquals(item1,item2))&&item1!==item2)return!1}return!0}}Iterables.ITERATOR_TYPE=check_1.HasPropertyType("next",check_1.InstanceofType(Function)),exports.Iterables=Iterables},"../immutable/ordered-map.ts":
/*!***********************************!*\
  !*** ../immutable/ordered-map.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_list_1=__webpack_require__(/*! ../immutable/immutable-list */"../immutable/immutable-list.ts"),immutable_set_1=__webpack_require__(/*! ../immutable/immutable-set */"../immutable/immutable-set.ts"),ordered_set_1=__webpack_require__(/*! ../immutable/ordered-set */"../immutable/ordered-set.ts"),orderings_1=__webpack_require__(/*! ../immutable/orderings */"../immutable/orderings.ts");class OrderedMap{constructor(keys,map){this.keys_=keys.slice(0),this.map_=new Map(map)}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}add([key,value]){if(this.map_.has(key))return this;const keysClone=this.keys_.slice(0);keysClone.push(key);const mapClone=new Map(this.map_);return mapClone.set(key,value),new OrderedMap(keysClone,mapClone)}addAll(items){const keysClone=this.keys_.slice(0),mapClone=new Map(this.map_),entriesToAdd=items.filterItem(([key,_])=>!this.hasKey(key));for(const[key,value]of entriesToAdd)keysClone.push(key),mapClone.set(key,value);return new OrderedMap(keysClone,mapClone)}delete(entry){return this.deleteAll(immutable_set_1.ImmutableSet.of([entry]))}deleteAll(items){const keysClone=this.keys_.slice(0),mapClone=new Map(this.map_);for(const[key,value]of items){if(this.map_.get(key)!==value)continue;const index=keysClone.indexOf(key);index>=0&&keysClone.splice(index,1),mapClone.delete(key)}return new OrderedMap(keysClone,mapClone)}deleteAllKeys(keys){const keysClone=this.keys_.slice(0),mapClone=new Map(this.map_);for(const key of keys){const index=keysClone.indexOf(key);index>=0&&keysClone.splice(index,1),mapClone.delete(key)}return new OrderedMap(keysClone,mapClone)}deleteAt(index){const keyToDelete=this.keys_[index];return void 0===keyToDelete?this:this.deleteKey(keyToDelete)}deleteKey(key){return this.deleteAllKeys(immutable_set_1.ImmutableSet.of([key]))}entries(){return immutable_list_1.ImmutableList.of(this.keys_).map(key=>{const value=this.map_.get(key);if(void 0===value)throw new Error(`Data inconsistency detected: ${key} has undefined value`);return[key,value]})}equals(other){if(this.size()!==other.size())return!1;for(let i=0;i<this.size();i++){const[thisKey,thisValue]=this.getAt(i),[otherKey,otherValue]=other.getAt(i);if(thisKey!==otherKey||thisValue!==otherValue)return!1}return!0}every(check){return this.everyItem(([key,value])=>check(value,key))}everyItem(check){for(const entry of this)if(!check(entry))return!1;return!0}filter(checker){return this.filterItem(([key,value])=>checker(value,key))}filterByType(checker){const newItems=[];for(const item of this)checker.check(item)&&newItems.push(item);return ordered_set_1.OrderedSet.of(newItems)}filterItem(checker){const filteredEntries=this.entries().filterItem(checker),keysClone=filteredEntries.mapItem(([key,_])=>key),mapClone=new Map([...filteredEntries]);return new OrderedMap([...keysClone],mapClone)}find(check){return this.findEntry((value,index)=>check([index,value]))}findEntry(checker){for(const[index,value]of this.entries())if(checker(value,index))return[index,value];return null}findKey(checker){const entry=this.findEntry(checker);return null===entry?null:entry[0]}findValue(checker){const entry=this.findEntry(checker);return null===entry?null:entry[1]}get(key){return this.map_.get(key)}getAt(index){const key=this.keys_[index];if(void 0===key)return;const value=this.get(key);return void 0!==value?[key,value]:void 0}has([key,value]){return this.map_.get(key)===value}hasKey(key){return this.map_.has(key)}insertAllAt(index,items){const keysToInsert=immutable_set_1.ImmutableSet.of(items).mapItem(([key])=>key),keysClone=immutable_list_1.ImmutableList.of(this.keys_).insertAllAt(index,keysToInsert),mapClone=new Map(this.map_);for(const[key,value]of items)mapClone.set(key,value);return new OrderedMap([...keysClone],mapClone)}insertAt(index,item){return this.insertAllAt(index,immutable_set_1.ImmutableSet.of([item]))}keys(){return this.entries().mapItem(([key,_])=>key)}map(fn){const keysClone=this.keys_.slice(0),mapClone=new Map;for(const[key,value]of this.map_)mapClone.set(key,fn(value,key));return new OrderedMap(keysClone,mapClone)}mapItem(fn){return ordered_set_1.OrderedSet.of([...this.map_].map(entry=>fn(entry)))}max(ordering){return this.reduceItem((prevValue,currentEntry)=>null===prevValue?currentEntry:-1===ordering(prevValue,currentEntry)?currentEntry:prevValue,null)}min(ordering){return this.max(orderings_1.Orderings.reverse(ordering))}reduce(fn,init){let result=init;for(const[key,value]of this)result=fn(result,value,key);return result}reduceItem(fn,init){return this.reduce((prev,value,key)=>fn(prev,[key,value]),init)}reverse(){return new OrderedMap(this.keys_.reverse(),new Map(this.map_))}set(key,value){const keysClone=this.keys_.slice(0),mapClone=new Map(this.map_);return mapClone.set(key,value),new OrderedMap(keysClone,mapClone)}setAt(index,value){return this.deleteAt(index).insertAt(index,value)}size(){return this.keys_.length}some(check){return this.someItem(([key,value])=>check(value,key))}someItem(check){for(const entry of this)if(check(entry))return!0;return!1}sort(compareFn){const keysClone=this.keys_.slice(0).sort((key1,key2)=>{const value1=this.get(key1),value2=this.get(key2);if(void 0===value1)throw new Error(`Data inconsistency detected: ${key1} has undefined value`);if(void 0===value2)throw new Error(`Data inconsistency detected: ${key2} has undefined value`);return compareFn([key1,value1],[key2,value2])});return new OrderedMap(keysClone,new Map(this.map_))}values(){return this.entries().mapItem(([_,value])=>value)}static of(entries){const keys=[],map=new Map;for(const[key,value]of entries)map.has(key)||(keys.push(key),map.set(key,value));return new OrderedMap(keys,map)}}exports.OrderedMap=OrderedMap},"../immutable/ordered-set.ts":
/*!***********************************!*\
  !*** ../immutable/ordered-set.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_set_1=__webpack_require__(/*! ./immutable-set */"../immutable/immutable-set.ts"),orderings_1=__webpack_require__(/*! ./orderings */"../immutable/orderings.ts");class OrderedSet{constructor(data){this.data_=data,this.set_=new Set(data)}[Symbol.iterator](){return this.data_[Symbol.iterator]()}add(item){if(this.set_.has(item))return this;const clone=this.data_.slice(0);return clone.push(item),new OrderedSet(clone)}addAll(items){const clone=this.data_.slice(0),itemsToAdd=items.filterItem(item=>!this.has(item));for(const item of itemsToAdd)clone.push(item);return new OrderedSet(clone)}delete(item){const index=this.data_.indexOf(item);if(index<0)return this;const clone=this.data_.slice(0);return clone.splice(index,1),new OrderedSet(clone)}deleteAll(items){const clone=this.data_.slice(0);for(const item of items){const index=clone.indexOf(item);index>=0&&clone.splice(index,1)}return new OrderedSet(clone)}deleteAt(index){const clone=this.data_.slice(0);return clone.splice(index,1),new OrderedSet(clone)}equals(other){if(this.size()!==other.size())return!1;for(let i=0;i<this.size();i++)if(this.getAt(i)!==other.getAt(i))return!1;return!0}everyItem(check){for(const item of this)if(!check(item))return!1;return!0}filterByType(checker){const newItems=[];for(const item of this)checker.check(item)&&newItems.push(item);return OrderedSet.of(newItems)}filterItem(checker){return new OrderedSet(this.data_.slice(0).filter(item=>checker(item)))}find(check){for(const item of this.data_)if(check(item))return item;return null}getAt(index){return this.data_[index]}has(item){return this.set_.has(item)}insertAllAt(index,items){let preInsertionCount=0;for(const item of items){const existingIndex=this.data_.indexOf(item);existingIndex>=0&&existingIndex<index&&preInsertionCount++}const clone=[...this.deleteAll(items)];return clone.splice(index-preInsertionCount,0,...items),new OrderedSet(clone)}insertAt(index,item){return this.insertAllAt(index,immutable_set_1.ImmutableSet.of([item]))}mapItem(fn){return new OrderedSet(this.data_.slice(0).map(item=>fn(item)))}max(ordering){return this.reduceItem((prevValue,value)=>null===prevValue?value:-1===ordering(prevValue,value)?value:prevValue,null)}min(ordering){return this.max(orderings_1.Orderings.reverse(ordering))}reduceItem(fn,init){return this.data_.reduce((prev,curr)=>fn(prev,curr),init)}reverse(){return new OrderedSet(this.data_.reverse())}setAt(index,item){return this.deleteAt(index).insertAt(index,item)}size(){return this.data_.length}someItem(check){for(const item of this)if(check(item))return!0;return!1}sort(compareFn){const clone=this.data_.slice(0);return clone.sort(compareFn),new OrderedSet(clone)}static of(items){const uniques=[],set=new Set;for(const item of items)set.has(item)||(set.add(item),uniques.push(item));return new OrderedSet(uniques)}}exports.OrderedSet=OrderedSet},"../immutable/orderings.ts":
/*!*********************************!*\
  !*** ../immutable/orderings.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const check_1=__webpack_require__(/*! ../check */"../check/index.ts"),immutable_list_1=__webpack_require__(/*! ../immutable/immutable-list */"../immutable/immutable-list.ts"),float_parser_1=__webpack_require__(/*! ../parse/float-parser */"../parse/float-parser.ts"),NATURAL_SPLIT_REGEXP=/([0-9]+)/;exports.Orderings={compound:orderings=>(item1,item2)=>{for(const ordering of orderings){const result=ordering(item1,item2);if(0!==result)return result}return 0},map:(mapFn,ordering)=>(item1,item2)=>ordering(mapFn(item1),mapFn(item2)),matches:matchFn=>(item1,item2)=>{const matches1=matchFn(item1),matches2=matchFn(item2);return matches1===matches2?0:matches1&&!matches2?-1:1},isOneOf(checked){const checkedSet=new Set(checked);return exports.Orderings.matches(item=>checkedSet.has(item))},natural:()=>(item1,item2)=>{const item1Chunks=item1.split(NATURAL_SPLIT_REGEXP),item2Chunks=item2.split(NATURAL_SPLIT_REGEXP),maxLength=Math.min(item1Chunks.length,item2Chunks.length),ordering=exports.Orderings.compound(immutable_list_1.ImmutableList.of([exports.Orderings.type(immutable_list_1.ImmutableList.of([check_1.NumberType,check_1.StringType])),exports.Orderings.normal()]));function normalize(str){const parsed=float_parser_1.FloatParser.parse(str);return null===parsed?str:parsed}for(let i=0;i<maxLength;i++){const result=ordering(normalize(item1Chunks[i]),normalize(item2Chunks[i]));if(0!==result)return result}return 0},normal:()=>(item1,item2)=>item1<item2?-1:item1>item2?1:0,reverse:ordering=>(item1,item2)=>ordering(item2,item1),type:types=>(item1,item2)=>{for(const type of types){const passes1=type.check(item1),passes2=type.check(item2);if(passes1!==passes2)return exports.Orderings.reverse(exports.Orderings.normal())(passes1,passes2)}return 0}}},"../immutable/tree-map.ts":
/*!********************************!*\
  !*** ../immutable/tree-map.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const check_1=__webpack_require__(/*! ../check */"../check/index.ts"),data_1=__webpack_require__(/*! ../data */"../data/index.ts"),immutable_list_1=__webpack_require__(/*! ../immutable/immutable-list */"../immutable/immutable-list.ts"),immutable_map_1=__webpack_require__(/*! ../immutable/immutable-map */"../immutable/immutable-map.ts");class TreeMap{constructor(value_,childNodes_=immutable_map_1.ImmutableMap.of([])){this.value_=value_,this.childNodes_=childNodes_}delete(key){return new TreeMap(this.value_,this.childNodes_.deleteKey(key))}getChildNode(key){return this.childNodes_.get(key)||null}getChildren(){return this.childNodes_.mapItem(([,node])=>node.getValue())}getKeys(){return this.childNodes_.keys()}getValue(){return this.value_}map(fn){return this.mapHelper_(fn,null,null)[1]}mapHelper_(fn,key,parent){const[newKey,newValue]=fn(this,key,parent),newChildren=immutable_map_1.ImmutableMap.of(this.childNodes_.mapItem(([key,value])=>value.mapHelper_(fn,key,this))).filterByType(check_1.TupleOfType([check_1.NonNullType(),check_1.InstanceofType(TreeMap)]));return[newKey,TreeMap.of(newValue,newChildren)]}postOrder(){return this.childNodes_.map(node=>node.postOrder()).reduce((prevValue,value)=>prevValue.addAll(value),immutable_list_1.ImmutableList.of([])).add(this)}preOrder(){const descendants=this.childNodes_.map(node=>node.preOrder()).reduce((prevValue,value)=>prevValue.addAll(value),immutable_list_1.ImmutableList.of([]));return immutable_list_1.ImmutableList.of([this,...descendants])}set(key,value){return new TreeMap(this.value_,this.childNodes_.set(key,value))}setValue(value){return new TreeMap(value,this.childNodes_)}static of(value,children=new Map){return new TreeMap(value,immutable_map_1.ImmutableMap.of([...children]))}static promiseAll(tree){return __awaiter(this,void 0,void 0,function*(){const promises=[];for(const node of tree.postOrder())promises.push(Promise.all([node,node.getValue()]));const results=yield Promise.all(promises),resultsMap=immutable_map_1.ImmutableMap.of(results);return tree.map((node,key)=>[key,resultsMap.get(node)])})}}__decorate([data_1.cache()],TreeMap.prototype,"postOrder",null),__decorate([data_1.cache()],TreeMap.prototype,"preOrder",null),exports.TreeMap=TreeMap},"../immutable/tree-set.ts":
/*!********************************!*\
  !*** ../immutable/tree-set.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};Object.defineProperty(exports,"__esModule",{value:!0});const data_1=__webpack_require__(/*! ../data */"../data/index.ts"),immutable_list_1=__webpack_require__(/*! ../immutable/immutable-list */"../immutable/immutable-list.ts"),immutable_map_1=__webpack_require__(/*! ../immutable/immutable-map */"../immutable/immutable-map.ts"),immutable_set_1=__webpack_require__(/*! ../immutable/immutable-set */"../immutable/immutable-set.ts");class TreeSet{constructor(value_,childNodes_=immutable_map_1.ImmutableMap.of([])){this.value_=value_,this.childNodes_=childNodes_}add(node){return new TreeSet(this.value_,this.childNodes_.set(node.getValue(),node))}delete(value){return new TreeSet(this.value_,this.childNodes_.deleteKey(value))}getChildNode(key){return this.childNodes_.get(key)||null}getChildren(){return this.childNodes_.keys()}getValue(){return this.value_}map(fn){return this.mapHelper_(fn,null)}mapHelper_(fn,parent){const newValue=fn(this,parent),newChildren=this.childNodes_.mapItem(([,value])=>{return value.mapHelper_(fn,this)});return TreeSet.of(newValue,newChildren)}postOrder(){return this.childNodes_.map(node=>node.postOrder()).reduce((prevValue,value)=>prevValue.addAll(value),immutable_list_1.ImmutableList.of([])).add(this)}preOrder(){const descendants=this.childNodes_.map(node=>node.preOrder()).reduce((prevValue,value)=>prevValue.addAll(value),immutable_list_1.ImmutableList.of([]));return immutable_list_1.ImmutableList.of([this,...descendants])}setValue(value){return new TreeSet(value,this.childNodes_)}static of(value,children=new Set){const mapContent=immutable_set_1.ImmutableSet.of([...children]).mapItem(child=>[child.getValue(),child]);return new TreeSet(value,immutable_map_1.ImmutableMap.of(mapContent))}}__decorate([data_1.cache()],TreeSet.prototype,"postOrder",null),__decorate([data_1.cache()],TreeSet.prototype,"preOrder",null),exports.TreeSet=TreeSet},"../immutable/vector2d.ts":
/*!********************************!*\
  !*** ../immutable/vector2d.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class Vector2d{constructor(x,y){this.x=x,this.y=y}add(other){return new Vector2d(this.x+other.x,this.y+other.y)}getLength(){return Math.sqrt(this.getLengthSquared())}getLengthSquared(){return this.x*this.x+this.y*this.y}mult(n){return new Vector2d(this.x*n,this.y*n)}static of(x,y){return new Vector2d(x,y)}}exports.Vector2d=Vector2d},"../inject/inject-util.ts":
/*!********************************!*\
  !*** ../inject/inject-util.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const __METADATA=Symbol("metadata");exports.InjectUtil=class InjectUtil{static getMetadataMap(ctor){return void 0===ctor[__METADATA]&&(ctor[__METADATA]=new Map),ctor[__METADATA]}}},"../inject/injector.ts":
/*!*****************************!*\
  !*** ../inject/injector.ts ***!
  \*****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const reflect_1=__webpack_require__(/*! ../util/reflect */"../util/reflect.ts"),inject_util_1=__webpack_require__(/*! ./inject-util */"../inject/inject-util.ts"),INJECTOR_BIND_KEY_="$gsInjector";class Injector{constructor(){this.instances_=new Map,this.instances_.set(INJECTOR_BIND_KEY_,this)}getBoundValue(bindKey,isOptional=!1){if(this.instances_.has(bindKey))return this.instances_.get(bindKey);if(!isOptional&&!Injector.BINDINGS_.has(bindKey))throw new Error(`No value bound to key ${bindKey}`);const instance=(Injector.BINDINGS_.has(bindKey)?Injector.BINDINGS_.get(bindKey):()=>void 0)(this);return this.instances_.set(bindKey,instance),instance}getParameters(ctor,extraArguments={}){const metadataMap=inject_util_1.InjectUtil.getMetadataMap(ctor),args=[];for(let i=0;i<ctor.length;i++)if(void 0!==extraArguments[i])args.push(extraArguments[i]);else{if(!metadataMap.has(i))throw new Error(`Cannot find injection candidate for index ${i} for ${ctor} when instantiating`);const metadata=metadataMap.get(i);args.push(this.getBoundValue(metadata.getKeyName(),metadata.isOptional()))}return args}instantiate(ctor,extraArguments={}){return reflect_1.Reflect.construct(ctor,this.getParameters(ctor,extraArguments))}static bind(ctor,bindKey){Injector.bindProvider(function(injector){return injector.instantiate(ctor)},bindKey)}static bindProvider(provider,bindKey){if(Injector.BINDINGS_.has(bindKey))throw new Error(`Binding ${bindKey} is already bound`);if(bindKey===INJECTOR_BIND_KEY_)throw new Error(`${INJECTOR_BIND_KEY_} is a reserved key`);Injector.BINDINGS_.set(bindKey,provider)}static newInstance(){return new Injector}}Injector.BINDINGS_=new Map,exports.Injector=Injector},"../jasmine/any-assert.ts":
/*!********************************!*\
  !*** ../jasmine/any-assert.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_assert_1=__webpack_require__(/*! ./base-assert */"../jasmine/base-assert.ts");exports.AnyAssert=class AnyAssert extends base_assert_1.BaseAssert{be(other){this.getMatchers_().toBe(other)}beAnInstanceOf(clazz){this.getMatchers_().toEqual(jasmine.any(clazz))}beDefined(){this.getMatchers_().toBeDefined()}beFalsy(){this.getMatchers_().toBeFalsy()}beNull(){this.getMatchers_().toBeNull()}beTruthy(){this.getMatchers_().toBeTruthy()}equal(other){this.getMatchers_().toEqual(other)}matchObject(obj){this.getMatchers_().toEqual(jasmine.objectContaining(obj))}}},"../jasmine/array-assert.ts":
/*!**********************************!*\
  !*** ../jasmine/array-assert.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const iterable_assert_1=__webpack_require__(/*! ../jasmine/iterable-assert */"../jasmine/iterable-assert.ts");exports.ArrayAssert=class ArrayAssert extends iterable_assert_1.IterableAssert{constructor(arrayValue,reversed,expect){super(arrayValue,reversed,expect)}contain(element){this.getMatchers_().toContain(element)}}},"../jasmine/assert-color.ts":
/*!**********************************!*\
  !*** ../jasmine/assert-color.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const assert_factory_1=__webpack_require__(/*! ../jasmine/assert-factory */"../jasmine/assert-factory.ts"),color_assert_1=__webpack_require__(/*! ../jasmine/color-assert */"../jasmine/color-assert.ts");exports.assertColor=function assertColor(value){return new assert_factory_1.AssertFactory(reversed=>new color_assert_1.ColorAssert(value,reversed,expect))}},"../jasmine/assert-factory.ts":
/*!************************************!*\
  !*** ../jasmine/assert-factory.ts ***!
  \************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.AssertFactory=class AssertFactory{constructor(provider_){this.provider_=provider_}get to(){return this.provider_(!1)}get toNot(){return this.provider_(!0)}}},"../jasmine/assert.ts":
/*!****************************!*\
  !*** ../jasmine/assert.ts ***!
  \****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const boolean_type_1=__webpack_require__(/*! ../check/boolean-type */"../check/boolean-type.ts"),finite_iterable_type_1=__webpack_require__(/*! ../check/finite-iterable-type */"../check/finite-iterable-type.ts"),iterable_type_1=__webpack_require__(/*! ../check/iterable-type */"../check/iterable-type.ts"),number_type_1=__webpack_require__(/*! ../check/number-type */"../check/number-type.ts"),string_type_1=__webpack_require__(/*! ../check/string-type */"../check/string-type.ts"),any_assert_1=__webpack_require__(/*! ../jasmine/any-assert */"../jasmine/any-assert.ts"),array_assert_1=__webpack_require__(/*! ../jasmine/array-assert */"../jasmine/array-assert.ts"),assert_factory_1=__webpack_require__(/*! ../jasmine/assert-factory */"../jasmine/assert-factory.ts"),boolean_assert_1=__webpack_require__(/*! ../jasmine/boolean-assert */"../jasmine/boolean-assert.ts"),element_assert_1=__webpack_require__(/*! ../jasmine/element-assert */"../jasmine/element-assert.ts"),finite_iterable_assert_1=__webpack_require__(/*! ../jasmine/finite-iterable-assert */"../jasmine/finite-iterable-assert.ts"),function_assert_1=__webpack_require__(/*! ../jasmine/function-assert */"../jasmine/function-assert.ts"),iterable_assert_1=__webpack_require__(/*! ../jasmine/iterable-assert */"../jasmine/iterable-assert.ts"),map_assert_1=__webpack_require__(/*! ../jasmine/map-assert */"../jasmine/map-assert.ts"),number_assert_1=__webpack_require__(/*! ../jasmine/number-assert */"../jasmine/number-assert.ts"),promise_assert_1=__webpack_require__(/*! ../jasmine/promise-assert */"../jasmine/promise-assert.ts"),set_assert_1=__webpack_require__(/*! ../jasmine/set-assert */"../jasmine/set-assert.ts"),string_assert_1=__webpack_require__(/*! ../jasmine/string-assert */"../jasmine/string-assert.ts");exports.assert=function assert(value){return boolean_type_1.BooleanType.check(value)?new assert_factory_1.AssertFactory(reversed=>new boolean_assert_1.BooleanAssert(value,reversed,expect)):string_type_1.StringType.check(value)?new assert_factory_1.AssertFactory(reversed=>new string_assert_1.StringAssert(value,reversed,expect)):number_type_1.NumberType.check(value)?new assert_factory_1.AssertFactory(reversed=>new number_assert_1.NumberAssert(value,reversed,expect)):value instanceof Element?new assert_factory_1.AssertFactory(reversed=>new element_assert_1.ElementAssert(value,reversed,expect)):value instanceof Function?new assert_factory_1.AssertFactory(reversed=>new function_assert_1.FunctionAssert(value,reversed,expect)):value instanceof Array?new assert_factory_1.AssertFactory(reversed=>new array_assert_1.ArrayAssert(value,reversed,expect)):value instanceof Map?new assert_factory_1.AssertFactory(reversed=>new map_assert_1.MapAssert(value,reversed,expect)):value instanceof Set?new assert_factory_1.AssertFactory(reversed=>new set_assert_1.SetAssert(value,reversed,expect)):value instanceof Promise?new assert_factory_1.AssertFactory(reversed=>new promise_assert_1.PromiseAssert(value,fail,reversed,expect)):finite_iterable_type_1.FiniteIterableType.check(value)?new assert_factory_1.AssertFactory(reversed=>new finite_iterable_assert_1.FiniteIterableAssert(value,reversed,expect)):iterable_type_1.IterableType.check(value)?new assert_factory_1.AssertFactory(reversed=>new iterable_assert_1.IterableAssert(value,reversed,expect)):new assert_factory_1.AssertFactory(reversed=>new any_assert_1.AnyAssert(value,reversed,expect))}},"../jasmine/base-assert.ts":
/*!*********************************!*\
  !*** ../jasmine/base-assert.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.BaseAssert=class BaseAssert{constructor(anyValue_,reversed_,expect_){this.anyValue_=anyValue_,this.reversed_=reversed_,this.expect_=expect_}getMatchers_(value=this.anyValue_){return this.reversed_?this.expect_(value).not:this.expect_(value)}}},"../jasmine/boolean-assert.ts":
/*!************************************!*\
  !*** ../jasmine/boolean-assert.ts ***!
  \************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_assert_1=__webpack_require__(/*! ../jasmine/base-assert */"../jasmine/base-assert.ts");exports.BooleanAssert=class BooleanAssert extends base_assert_1.BaseAssert{constructor(booleanValue,reversed,expect){super(booleanValue,reversed,expect)}be(value){this.getMatchers_().toBe(value)}beFalse(){this.be(!1)}beTrue(){this.be(!0)}}},"../jasmine/color-assert.ts":
/*!**********************************!*\
  !*** ../jasmine/color-assert.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const any_assert_1=__webpack_require__(/*! ../jasmine/any-assert */"../jasmine/any-assert.ts");exports.ColorAssert=class ColorAssert extends any_assert_1.AnyAssert{constructor(color,reversed,expect){super(color,reversed,expect),this.colorValue_=color}haveHsl(hue,saturation,lightness){if(null===this.colorValue_)return void this.getMatchers_().not.toBeNull();const hslArray=[this.colorValue_.getHue(),this.colorValue_.getSaturation(),this.colorValue_.getLightness()];this.getMatchers_(hslArray).toEqual([hue,saturation,lightness])}haveRgb(red,green,blue){if(null===this.colorValue_)return void this.getMatchers_().not.toBeNull();const rgbArray=[this.colorValue_.getRed(),this.colorValue_.getGreen(),this.colorValue_.getBlue()];this.getMatchers_(rgbArray).toEqual([red,green,blue])}}},"../jasmine/element-assert.ts":
/*!************************************!*\
  !*** ../jasmine/element-assert.ts ***!
  \************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const any_assert_1=__webpack_require__(/*! ./any-assert */"../jasmine/any-assert.ts");exports.ElementAssert=class ElementAssert extends any_assert_1.AnyAssert{constructor(elementValue,reversed,expect){super(elementValue,reversed,expect),this.elementValue_=elementValue}haveChildren(expectedChildren){const children=[];for(let i=0;i<this.elementValue_.children.length;i++)children.push(this.elementValue_.children.item(i));this.getMatchers_(children).toEqual(expectedChildren)}haveClasses(expectedClasses){const classes=[];for(let i=0;i<this.elementValue_.classList.length;i++)classes.push(this.elementValue_.classList.item(i));this.getMatchers_(classes).toEqual(expectedClasses)}}},"../jasmine/finite-iterable-assert.ts":
/*!********************************************!*\
  !*** ../jasmine/finite-iterable-assert.ts ***!
  \********************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const iterable_assert_1=__webpack_require__(/*! ../jasmine/iterable-assert */"../jasmine/iterable-assert.ts");exports.FiniteIterableAssert=class FiniteIterableAssert extends iterable_assert_1.IterableAssert{constructor(finiteIterableValue_,reversed,expect){super(finiteIterableValue_,reversed,expect),this.finiteIterableValue_=finiteIterableValue_}haveElements(elements){const values=[];for(const value of this.finiteIterableValue_)values.push(value);this.getMatchers_(values).toEqual(elements)}}},"../jasmine/function-assert.ts":
/*!*************************************!*\
  !*** ../jasmine/function-assert.ts ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const any_assert_1=__webpack_require__(/*! ./any-assert */"../jasmine/any-assert.ts");exports.FunctionAssert=class FunctionAssert extends any_assert_1.AnyAssert{constructor(functionValue,reversed,expect){super(functionValue,reversed,expect)}haveBeenCalled(){this.getMatchers_().toHaveBeenCalled()}haveBeenCalledTimes(times){this.getMatchers_().toHaveBeenCalledTimes(times)}get haveBeenCalledWith(){return(...args)=>{const matchers=this.getMatchers_();matchers.toHaveBeenCalledWith.apply(matchers,args)}}throw(){this.getMatchers_().toThrow()}throwError(regexp){this.getMatchers_().toThrowError(regexp)}}},"../jasmine/iterable-assert.ts":
/*!*************************************!*\
  !*** ../jasmine/iterable-assert.ts ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const any_assert_1=__webpack_require__(/*! ./any-assert */"../jasmine/any-assert.ts");exports.IterableAssert=class IterableAssert extends any_assert_1.AnyAssert{constructor(iterableValue_,reversed,expect){super(iterableValue_,reversed,expect),this.iterableValue_=iterableValue_}startWith(expected){const iterator=this.iterableValue_[Symbol.iterator](),toCheck=[];let result=iterator.next();for(const _ of expected){if(result.done)break;toCheck.push(result.value),result=iterator.next()}this.getMatchers_(toCheck).toEqual(expected)}}},"../jasmine/map-assert.ts":
/*!********************************!*\
  !*** ../jasmine/map-assert.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts"),any_assert_1=__webpack_require__(/*! ../jasmine/any-assert */"../jasmine/any-assert.ts");exports.MapAssert=class MapAssert extends any_assert_1.AnyAssert{constructor(mapValue,reversed,expect){super(mapValue,reversed,expect),this.mapValue_=mapValue}haveEntries(entries){this.getMatchers_([...immutable_1.ImmutableMap.of(this.mapValue_).entries()]).toEqual(entries)}}},"../jasmine/matchers.ts":
/*!******************************!*\
  !*** ../jasmine/matchers.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class MatcherBuilder{constructor(mapFns_){this.mapFns_=mapFns_}any(ctor){return this.createMatcher_(jasmine.any(ctor))}anyFunction(){return this.createMatcher_(jasmine.any(Function))}anyInstanceOf(obj){return this.createMatcher_(jasmine.any(obj.constructor))}anyString(){return this.createMatcher_(jasmine.any(String))}anyThing(){return this.createMatcher_(jasmine.anything())}arrayContaining(obj){return this.createMatcher_(jasmine.arrayContaining(obj))}createMatcher_(asymmetricMatcher){return{asymmetricMatch:(actual,...args)=>{const mappedActual=this.mapFns_.reduce((previous,current)=>current(previous),actual);return asymmetricMatcher.asymmetricMatch(mappedActual,...args)}}}map(mapFn){const fns=[...this.mapFns_];return fns.push(mapFn),new MatcherBuilder(fns)}objectContaining(obj){return this.createMatcher_(jasmine.objectContaining(obj))}stringMatching(regexp){return this.createMatcher_(jasmine.stringMatching(regexp))}}exports.Matchers=new MatcherBuilder([])},"../jasmine/number-assert.ts":
/*!***********************************!*\
  !*** ../jasmine/number-assert.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const any_assert_1=__webpack_require__(/*! ./any-assert */"../jasmine/any-assert.ts");exports.NumberAssert=class NumberAssert extends any_assert_1.AnyAssert{beCloseTo(other,precision){this.getMatchers_().toBeCloseTo(other,precision)}}},"../jasmine/promise-assert.ts":
/*!************************************!*\
  !*** ../jasmine/promise-assert.ts ***!
  \************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const any_assert_1=__webpack_require__(/*! ../jasmine/any-assert */"../jasmine/any-assert.ts");exports.PromiseAssert=class PromiseAssert extends any_assert_1.AnyAssert{constructor(promise_,fail_,reversed,expect){if(super(promise_,reversed,expect),this.promise_=promise_,this.fail_=fail_,reversed)throw new Error("Reversed is not supported for Promise asserts")}reject(){return __awaiter(this,void 0,void 0,function*(){try{return yield this.promise_,this.fail_("Expected to reject")}catch(e){return e}})}rejectWithError(errorMsg){return __awaiter(this,void 0,void 0,function*(){return this.rejectWithErrorType(Error,errorMsg)})}rejectWithErrorType(errorType,errorMsg){return __awaiter(this,void 0,void 0,function*(){try{return yield this.promise_,this.fail_(`Expected to reject with "${errorMsg}`)}catch(e){this.getMatchers_(e).toEqual(jasmine.any(errorType));const error=e;return this.getMatchers_(error.message).toMatch(errorMsg),error}})}resolveWith(expected){return __awaiter(this,void 0,void 0,function*(){const resolveValue=yield this.promise_;return this.getMatchers_(resolveValue).toEqual(expected),resolveValue})}}},"../jasmine/set-assert.ts":
/*!********************************!*\
  !*** ../jasmine/set-assert.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts"),any_assert_1=__webpack_require__(/*! ../jasmine/any-assert */"../jasmine/any-assert.ts");exports.SetAssert=class SetAssert extends any_assert_1.AnyAssert{constructor(setValue,reversed,expect){super(setValue,reversed,expect),this.setValue_=setValue}haveElements(elements){this.getMatchers_([...immutable_1.ImmutableSet.of(this.setValue_)]).toEqual(elements)}}},"../jasmine/string-assert.ts":
/*!***********************************!*\
  !*** ../jasmine/string-assert.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const any_assert_1=__webpack_require__(/*! ./any-assert */"../jasmine/any-assert.ts");exports.StringAssert=class StringAssert extends any_assert_1.AnyAssert{constructor(stringValue,reversed,expect){super(stringValue,reversed,expect)}match(regexp){this.getMatchers_().toEqual(jasmine.stringMatching(regexp))}}},"../mock/fakes.ts":
/*!************************!*\
  !*** ../mock/fakes.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class WhenBuilder{constructor(args,spy,callSpecs){this.args_=args,this.callSpecs_=callSpecs,this.spy_=spy}call(handler){const newCallSpecs=this.callSpecs_.concat([{args:this.args_,handler:handler}]);return this.spy_.and.callFake((...args)=>{const callSpec=newCallSpecs.find(callSpec=>{let matches=!0;for(let i=0;i<callSpec.args.length&&matches;i++){const arg=callSpec.args[i];matches="function"==typeof arg.jasmineMatches?matches&&arg.jasmineMatches(args[i]):"function"==typeof arg.asymmetricMatch?matches&&arg.asymmetricMatch(args[i]):arg instanceof Element||"function"!=typeof arg.matches?matches&&callSpec.args[i]===args[i]:matches&&arg.matches(args[i])}return matches});if(void 0!==callSpec)return callSpec.handler(...args)}),new FakesContinuationBuilder(this.spy_,newCallSpecs)}resolve(value){return this.return(Promise.resolve(value))}return(value){return this.call(()=>value)}}class ElseBuilder{constructor(spy,callSpecs){this.spy_=spy,this.whenBuilder_=new WhenBuilder([],spy,callSpecs)}call(handler){return this.whenBuilder_.call(handler),this.spy_}resolve(value){return this.return(Promise.resolve(value))}return(value){return this.call(()=>value)}}class FakesContinuationBuilder{constructor(spy,callSpecs){this.callSpecs_=callSpecs,this.spy_=spy}else(){return new ElseBuilder(this.spy_,this.callSpecs_)}when(...args){return new WhenBuilder(args,this.spy_,this.callSpecs_)}}class Fakes extends FakesContinuationBuilder{constructor(spy){super(spy,[])}call(handler){return this.else().call(handler)}static build(spy){return new Fakes(spy)}}exports.Fakes=Fakes},"../mock/mocks.ts":
/*!************************!*\
  !*** ../mock/mocks.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_disposable_1=__webpack_require__(/*! ../dispose/base-disposable */"../dispose/base-disposable.ts"),disposable_function_1=__webpack_require__(/*! ../dispose/disposable-function */"../dispose/disposable-function.ts"),__id="$id";class Mocks{static builder(name,methods){const baseObj=Mocks.object(name);return methods.forEach(method=>{baseObj[method]=(()=>baseObj)}),baseObj}static disposable(name){const mock=new base_disposable_1.BaseDisposable;return mock[__id]=name,mock}static getter(target,name,value){Object.defineProperty(target,name,{get:()=>value})}static itemList(items){return{length:items.length,item:index=>items[index]}}static listenable(name,target){const mock=Mocks.disposable(name);return mock.on=(()=>new disposable_function_1.DisposableFunction(()=>void 0)),mock.dispatch=(()=>void 0),mock.getEventTarget=(()=>target),mock}static object(name,objType=Object){const mock={[__id]:name};return Object.setPrototypeOf(mock,objType.prototype),mock}}exports.Mocks=Mocks},"../parse/float-parser.ts":
/*!********************************!*\
  !*** ../parse/float-parser.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FloatParser={parse(input){if(null===input)return null;{const result=Number.parseFloat(input);return Number.isNaN(result)?null:result}},stringify:value=>null===value?"":value.toString(10)}},"../path/absolute-path-parser.ts":
/*!***************************************!*\
  !*** ../path/absolute-path-parser.ts ***!
  \***************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts"),absolute_path_1=__webpack_require__(/*! ../path/absolute-path */"../path/absolute-path.ts"),path_1=__webpack_require__(/*! ../path/path */"../path/path.ts");exports.AbsolutePathParser={parse(input){if(!input)return null;const parts=input.split(path_1.Path.SEPARATOR);return""!==parts[0]?null:new absolute_path_1.AbsolutePath(immutable_1.ImmutableList.of(parts.slice(1)))},stringify:value=>value?value.toString():""}},"../path/absolute-path.ts":
/*!********************************!*\
  !*** ../path/absolute-path.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};Object.defineProperty(exports,"__esModule",{value:!0});const data_1=__webpack_require__(/*! ../data */"../data/index.ts"),path_1=__webpack_require__(/*! ../path/path */"../path/path.ts");class AbsolutePath extends path_1.Path{toString(){return`/${[...this.getParts()].join(path_1.Path.SEPARATOR)}`}}__decorate([data_1.cache()],AbsolutePath.prototype,"toString",null),exports.AbsolutePath=AbsolutePath},"../path/index.ts":
/*!************************!*\
  !*** ../path/index.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var absolute_path_1=__webpack_require__(/*! ./absolute-path */"../path/absolute-path.ts");exports.AbsolutePath=absolute_path_1.AbsolutePath;var absolute_path_parser_1=__webpack_require__(/*! ./absolute-path-parser */"../path/absolute-path-parser.ts");exports.AbsolutePathParser=absolute_path_parser_1.AbsolutePathParser;var path_1=__webpack_require__(/*! ./path */"../path/path.ts");exports.Path=path_1.Path;var path_parser_1=__webpack_require__(/*! ./path-parser */"../path/path-parser.ts");exports.PathParser=path_parser_1.PathParser;var paths_1=__webpack_require__(/*! ./paths */"../path/paths.ts");exports.Paths=paths_1.Paths;var relative_path_1=__webpack_require__(/*! ./relative-path */"../path/relative-path.ts");exports.RelativePath=relative_path_1.RelativePath;var relative_path_parser_1=__webpack_require__(/*! ./relative-path-parser */"../path/relative-path-parser.ts");exports.RelativePathParser=relative_path_parser_1.RelativePathParser},"../path/path-parser.ts":
/*!******************************!*\
  !*** ../path/path-parser.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const absolute_path_parser_1=__webpack_require__(/*! ../path/absolute-path-parser */"../path/absolute-path-parser.ts"),relative_path_parser_1=__webpack_require__(/*! ../path/relative-path-parser */"../path/relative-path-parser.ts");exports.PathParser={parse:input=>relative_path_parser_1.RelativePathParser.parse(input)||absolute_path_parser_1.AbsolutePathParser.parse(input),stringify:value=>value?value.toString():""}},"../path/path.ts":
/*!***********************!*\
  !*** ../path/path.ts ***!
  \***********************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts");class Path{constructor(parts){this.parts_=immutable_1.ImmutableList.of([...parts])}getParts(){return this.parts_}}Path.SEPARATOR="/",exports.Path=Path},"../path/paths.ts":
/*!************************!*\
  !*** ../path/paths.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const error_1=__webpack_require__(/*! ../error */"../error/index.ts"),immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts"),absolute_path_1=__webpack_require__(/*! ../path/absolute-path */"../path/absolute-path.ts"),absolute_path_parser_1=__webpack_require__(/*! ../path/absolute-path-parser */"../path/absolute-path-parser.ts"),relative_path_1=__webpack_require__(/*! ../path/relative-path */"../path/relative-path.ts"),relative_path_parser_1=__webpack_require__(/*! ../path/relative-path-parser */"../path/relative-path-parser.ts"),typescript_1=__webpack_require__(/*! ../typescript */"../typescript/index.ts");class Paths{static absolutePath(pathString){const path=absolute_path_parser_1.AbsolutePathParser.parse(pathString);if(!path)throw error_1.Errors.assert("pathString").shouldBe("a valid absolute path").butWas(pathString);return path}static getDirPath(path){const parts=path.getParts().slice(0,-1);if(path instanceof absolute_path_1.AbsolutePath)return new absolute_path_1.AbsolutePath(parts);if(path instanceof relative_path_1.RelativePath)return new relative_path_1.RelativePath(parts);throw typescript_1.assertUnreachable(path)}static getFilenameParts(filename){const parts=filename.split("."),extensionIndex=Math.max(1,parts.length-1);return{extension:parts[extensionIndex]||"",name:parts.slice(0,extensionIndex).join(".")}}static getItemName(path){return path.getParts().getAt(-1)||null}static getRelativePath(srcPath,destPath){let commonCount=0;const thisParts=srcPath.getParts(),thatParts=destPath.getParts();for(;commonCount<Math.min(thisParts.size(),thatParts.size())-1&&thisParts.getAt(commonCount)===thatParts.getAt(commonCount);)commonCount++;const upCount=thisParts.size()-commonCount,parts=[];for(let i=0;i<upCount;i++)parts.push("..");return new relative_path_1.RelativePath(immutable_1.ImmutableList.of(parts).addAll(thatParts.slice(upCount)))}static getSubPathsToRoot(path){const subpaths=[];let currentPath=path;for(;currentPath&&currentPath.getParts().size()>0;)subpaths.push(currentPath),currentPath=Paths.getDirPath(currentPath);return immutable_1.ImmutableList.of(subpaths)}static join(root,...paths){const srcParts=[...root.getParts()];for(const path of paths)for(const part of path.getParts())srcParts.push(part);if(root instanceof absolute_path_1.AbsolutePath)return Paths.normalize(new absolute_path_1.AbsolutePath(immutable_1.ImmutableList.of(srcParts)));if(root instanceof relative_path_1.RelativePath)return Paths.normalize(new relative_path_1.RelativePath(immutable_1.ImmutableList.of(srcParts)));throw typescript_1.assertUnreachable(root)}static normalize(path){const noEmptyParts=[...path.getParts().filter(part=>!!part)],noCurrentParts=[];for(let i=0;i<noEmptyParts.length;i++){const part=noEmptyParts[i];0!==i&&"."===part||noCurrentParts.push(part)}const nonDoubleDotEntry=immutable_1.ImmutableList.of(noCurrentParts).findEntry(part=>".."!==part),nonDoubleIndex=nonDoubleDotEntry?nonDoubleDotEntry[0]+1:0,normalizedParts=[];for(let i=0;i<nonDoubleIndex;i++)normalizedParts.push(noCurrentParts[i]);for(let i=nonDoubleIndex;i<noCurrentParts.length;i++){const part=noCurrentParts[i];".."===part&&normalizedParts.length>0&&".."!==normalizedParts[normalizedParts.length-1]?normalizedParts.pop():normalizedParts.push(part)}if(path instanceof absolute_path_1.AbsolutePath)return new absolute_path_1.AbsolutePath(immutable_1.ImmutableList.of(normalizedParts));if(path instanceof relative_path_1.RelativePath)return new relative_path_1.RelativePath(immutable_1.ImmutableList.of(normalizedParts));throw typescript_1.assertUnreachable(path)}static relativePath(pathString){const path=relative_path_parser_1.RelativePathParser.parse(pathString);if(!path)throw error_1.Errors.assert("pathString").shouldBe("a valid relative path").butWas(pathString);return path}static setFilenameExt(filename,extension){const{name:name}=Paths.getFilenameParts(filename);return extension?`${name}.${extension}`:name}}exports.Paths=Paths},"../path/relative-path-parser.ts":
/*!***************************************!*\
  !*** ../path/relative-path-parser.ts ***!
  \***************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const immutable_1=__webpack_require__(/*! ../immutable */"../immutable/index.ts"),path_1=__webpack_require__(/*! ../path/path */"../path/path.ts"),relative_path_1=__webpack_require__(/*! ../path/relative-path */"../path/relative-path.ts");exports.RelativePathParser={parse(input){if(!input)return null;const parts=input.split(path_1.Path.SEPARATOR);return""===parts[0]?null:new relative_path_1.RelativePath(immutable_1.ImmutableList.of(parts))},stringify:value=>value?value.toString():""}},"../path/relative-path.ts":
/*!********************************!*\
  !*** ../path/relative-path.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};Object.defineProperty(exports,"__esModule",{value:!0});const data_1=__webpack_require__(/*! ../data */"../data/index.ts"),path_1=__webpack_require__(/*! ../path/path */"../path/path.ts");class RelativePath extends path_1.Path{toString(){return`${[...this.getParts()].join(path_1.Path.SEPARATOR)}`}}__decorate([data_1.cache()],RelativePath.prototype,"toString",null),exports.RelativePath=RelativePath},"../path/testing/index.ts":
/*!********************************!*\
  !*** ../path/testing/index.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var path_matcher_1=__webpack_require__(/*! ./path-matcher */"../path/testing/path-matcher.ts");exports.PathMatcher=path_matcher_1.PathMatcher},"../path/testing/path-matcher.ts":
/*!***************************************!*\
  !*** ../path/testing/path-matcher.ts ***!
  \***************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const path_1=__webpack_require__(/*! ../../path */"../path/index.ts"),testing_1=__webpack_require__(/*! ../../testing */"../testing/index.ts");class PathMatcher{constructor(pathString_){this.pathString_=pathString_}matches(other){return other instanceof path_1.Path&&other.toString()===this.pathString_}static with(pathString){return new PathMatcher(pathString)}}PathMatcher.testSetup=testing_1.matcherTestSetup(PathMatcher),exports.PathMatcher=PathMatcher},"../test-base.ts":
/*!***********************!*\
  !*** ../test-base.ts ***!
  \***********************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const graph_1=__webpack_require__(/*! ./graph */"../graph/index.ts"),testing_1=__webpack_require__(/*! ./path/testing */"../path/testing/index.ts"),testing_2=__webpack_require__(/*! ./testing */"../testing/index.ts"),log_1=__webpack_require__(/*! ./util/log */"../util/log.ts");var assert_1=__webpack_require__(/*! ./jasmine/assert */"../jasmine/assert.ts");exports.assert=assert_1.assert;var assert_color_1=__webpack_require__(/*! ./jasmine/assert-color */"../jasmine/assert-color.ts");exports.assertColor=assert_color_1.assertColor;var matchers_1=__webpack_require__(/*! ./jasmine/matchers */"../jasmine/matchers.ts");exports.Matchers=matchers_1.Matchers;var fakes_1=__webpack_require__(/*! ./mock/fakes */"../mock/fakes.ts");exports.Fakes=fakes_1.Fakes;var mocks_1=__webpack_require__(/*! ./mock/mocks */"../mock/mocks.ts");exports.Mocks=mocks_1.Mocks;const TEST_SETUP=new testing_2.TestSetup([testing_1.PathMatcher.testSetup,testing_2.TestAsync,testing_2.TestDispose,testing_2.TestEvent,graph_1.TestGraph,testing_2.TestJasmine]);let initialized=!1;exports.TestBase={setup(){initialized||(TEST_SETUP.setup(),log_1.Log.setEnabledLevel(log_1.LogLevel.OFF),initialized=!0)}}},"../testing/index.ts":
/*!***************************!*\
  !*** ../testing/index.ts ***!
  \***************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var matcher_test_setup_1=__webpack_require__(/*! ./matcher-test-setup */"../testing/matcher-test-setup.ts");exports.matcherTestSetup=matcher_test_setup_1.matcherTestSetup;var test_async_1=__webpack_require__(/*! ./test-async */"../testing/test-async.ts");exports.TestAsync=test_async_1.TestAsync;var test_dispose_1=__webpack_require__(/*! ./test-dispose */"../testing/test-dispose.ts");exports.TestDispose=test_dispose_1.TestDispose;var test_event_1=__webpack_require__(/*! ./test-event */"../testing/test-event.ts");exports.TestEvent=test_event_1.TestEvent;var test_inject_1=__webpack_require__(/*! ./test-inject */"../testing/test-inject.ts");exports.TestInject=test_inject_1.TestInject;var test_jasmine_1=__webpack_require__(/*! ./test-jasmine */"../testing/test-jasmine.ts");exports.TestJasmine=test_jasmine_1.TestJasmine;var test_setup_1=__webpack_require__(/*! ./test-setup */"../testing/test-setup.ts");exports.TestSetup=test_setup_1.TestSetup},"../testing/matcher-test-setup.ts":
/*!****************************************!*\
  !*** ../testing/matcher-test-setup.ts ***!
  \****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.matcherTestSetup=function matcherTestSetup(ctor){return{afterEach(){},beforeEach(){jasmine.addCustomEqualityTester((first,second)=>first instanceof ctor?first.matches(second):second instanceof ctor?second.matches(first):void 0)},init(){}}}},"../testing/test-async.ts":
/*!********************************!*\
  !*** ../testing/test-async.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const asyncs_1=__webpack_require__(/*! ../async/asyncs */"./asyncs.ts");exports.TestAsync={afterEach(){},beforeEach(){spyOn(asyncs_1.Asyncs,"run").and.callFake(fn=>fn())},init(){}}},"../testing/test-dispose.ts":
/*!**********************************!*\
  !*** ../testing/test-dispose.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_disposable_1=__webpack_require__(/*! ../dispose/base-disposable */"../dispose/base-disposable.ts"),DISPOSABLES=[];exports.TestDispose={add(...disposables){disposables.forEach(disposable=>{DISPOSABLES.push(disposable)})},afterEach(){DISPOSABLES.forEach(disposable=>disposable.dispose()),base_disposable_1.Flags.enableTracking=!1,expect(base_disposable_1.TRACKED_DISPOSABLES).toEqual([]),base_disposable_1.TRACKED_DISPOSABLES.splice(0,base_disposable_1.TRACKED_DISPOSABLES.length)},beforeEach(){DISPOSABLES.splice(0,DISPOSABLES.length),base_disposable_1.Flags.enableTracking=!0},init(){}}},"../testing/test-event.ts":
/*!********************************!*\
  !*** ../testing/test-event.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};Object.defineProperty(exports,"__esModule",{value:!0});const test_dispose_1=__webpack_require__(/*! ../testing/test-dispose */"../testing/test-dispose.ts"),deprecated_1=__webpack_require__(/*! ../typescript/deprecated */"../typescript/deprecated.ts"),log_1=__webpack_require__(/*! ../util/log */"../util/log.ts"),__calls=Symbol("calls"),LOGGER=log_1.Log.of("testing.TestEvent");class TestEvent{static afterEach(){}static beforeEach(){}static getPayloads(target,eventType){if(!target[__calls])throw Error(`Target ${target} has not been spied on`);return target[__calls].get(eventType)||[]}static init(){}static spyOn(target,eventTypes){target[__calls]||(target[__calls]=new Map),eventTypes.forEach(eventType=>{test_dispose_1.TestDispose.add(target.on(eventType,payload=>{target[__calls].has(eventType)||target[__calls].set(eventType,[]),target[__calls].get(eventType).push(payload)},this))})}}__decorate([deprecated_1.deprecated(LOGGER,"Use 'spyOn dispatchEvent'")],TestEvent,"getPayloads",null),__decorate([deprecated_1.deprecated(LOGGER,"Use 'spyOn dispatchEvent'")],TestEvent,"spyOn",null),exports.TestEvent=TestEvent},"../testing/test-inject.ts":
/*!*********************************!*\
  !*** ../testing/test-inject.ts ***!
  \*********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const injector_1=__webpack_require__(/*! ../inject/injector */"../inject/injector.ts"),BOUND_VALUES_=new Map;exports.TestInject={getBoundValue:bindKey=>BOUND_VALUES_.get(bindKey),afterEach(){},beforeEach(){BOUND_VALUES_.clear(),spyOn(injector_1.Injector,"bind").and.callFake((ctor,bindKey)=>{BOUND_VALUES_.set(bindKey,ctor)}),spyOn(injector_1.Injector,"bindProvider").and.callFake((provider,bindKey)=>{BOUND_VALUES_.set(bindKey,provider)})},init(){}}},"../testing/test-jasmine.ts":
/*!**********************************!*\
  !*** ../testing/test-jasmine.ts ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const log_1=__webpack_require__(/*! ../util/log */"../util/log.ts");exports.TestJasmine={afterEach(){},beforeEach(){log_1.Log.setColorEnabled(!1)},init(){function runTest(origRun,description,callback){origRun(description,callback?done=>{const promise=callback(done);promise instanceof Promise?promise.then(done,done.fail):done()}:callback)}window.jasminePatched||(window.fit=runTest.bind(window,fit),window.it=runTest.bind(window,it),window.jasminePatched=!0),jasmine.MAX_PRETTY_PRINT_DEPTH=2,jasmine.MAX_PRETTY_PRINT_ARRAY_LENGTH=5}}},"../testing/test-setup.ts":
/*!********************************!*\
  !*** ../testing/test-setup.ts ***!
  \********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.TestSetup=class TestSetup{constructor(setups){this.setups_=setups}setup(){this.setups_.forEach(setup=>{setup.init()}),beforeEach(()=>{this.setups_.forEach(setup=>{setup.beforeEach()})}),afterEach(()=>{this.setups_.forEach(setup=>{setup.afterEach()})})}}},"../typescript/assert-unreachable.ts":
/*!*******************************************!*\
  !*** ../typescript/assert-unreachable.ts ***!
  \*******************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertUnreachable=function assertUnreachable(_){throw new Error("Unreachable code reached")}},"../typescript/deprecated.ts":
/*!***********************************!*\
  !*** ../typescript/deprecated.ts ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const log_1=__webpack_require__(/*! ../util/log */"../util/log.ts");exports.deprecated=function deprecated(log,message){return function(_,propertyKey,descriptor){const origValue=descriptor.value;return descriptor.value=function(...args){return log_1.Log.warn(log,propertyKey.toString(),"is deprecated:",message),origValue.apply(this,args)},descriptor}}},"../typescript/enums.ts":
/*!******************************!*\
  !*** ../typescript/enums.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.Enums=class Enums{static fromLowerCaseString(stringValue,enumSet){return enumSet[stringValue.toUpperCase()]}static fromNumberString(stringValue,enumSet){return enumSet[enumSet[stringValue]]}static getAllValues(enumSet){const values=[];let index=0;for(;void 0!==enumSet[index];)values.push(index),index++;return values}static toLowerCaseString(enumValue,enumSet){return enumSet[enumValue].toLowerCase()}}},"../typescript/equals.ts":
/*!*******************************!*\
  !*** ../typescript/equals.ts ***!
  \*******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.equals=function equals(item1,item2){if(item1===item2)return!0;if(item1 instanceof Function&&item2 instanceof Function)return item1===item2;if(item1 instanceof Object&&item2 instanceof Object){if(!(item1 instanceof item2.constructor&&item2 instanceof item1.constructor))return!1;for(const key in item1)if(!equals(item1[key],item2[key]))return!1;return!0}return item1===item2}},"../typescript/force-import.ts":
/*!*************************************!*\
  !*** ../typescript/force-import.ts ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.forceImport=function forceImport(obj){console.debug("Force import",obj)}},"../typescript/index.ts":
/*!******************************!*\
  !*** ../typescript/index.ts ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var assert_unreachable_1=__webpack_require__(/*! ./assert-unreachable */"../typescript/assert-unreachable.ts");exports.assertUnreachable=assert_unreachable_1.assertUnreachable;var deprecated_1=__webpack_require__(/*! ./deprecated */"../typescript/deprecated.ts");exports.deprecated=deprecated_1.deprecated;var enums_1=__webpack_require__(/*! ./enums */"../typescript/enums.ts");exports.Enums=enums_1.Enums;var equals_1=__webpack_require__(/*! ./equals */"../typescript/equals.ts");exports.equals=equals_1.equals;var force_import_1=__webpack_require__(/*! ./force-import */"../typescript/force-import.ts");exports.forceImport=force_import_1.forceImport;var is_descendant_of_1=__webpack_require__(/*! ./is-descendant-of */"../typescript/is-descendant-of.ts");exports.isDescendantOf=is_descendant_of_1.isDescendantOf},"../typescript/is-descendant-of.ts":
/*!*****************************************!*\
  !*** ../typescript/is-descendant-of.ts ***!
  \*****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDescendantOf=function isDescendantOf(descendantCtor,ancestorCtor){return descendantCtor.prototype instanceof ancestorCtor}},"../util/hash.ts":
/*!***********************!*\
  !*** ../util/hash.ts ***!
  \***********************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HASHED_VALUES=new Map,exports.HASHED_OBJECTS=new WeakMap,exports.GLOBALS={lastHash:0},exports.hash=function hash(object){const mapLike=object instanceof Object?exports.HASHED_OBJECTS:exports.HASHED_VALUES;return mapLike.has(object)||(mapLike.set(object,exports.GLOBALS.lastHash),exports.GLOBALS.lastHash++),`${mapLike.get(object)}`}},"../util/index.ts":
/*!************************!*\
  !*** ../util/index.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var log_1=__webpack_require__(/*! ./log */"../util/log.ts");exports.Log=log_1.Log,exports.LogLevel=log_1.LogLevel;var reflect_1=__webpack_require__(/*! ./reflect */"../util/reflect.ts");exports.Reflect=reflect_1.Reflect},"../util/log.ts":
/*!**********************!*\
  !*** ../util/log.ts ***!
  \**********************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var LogLevel;Object.defineProperty(exports,"__esModule",{value:!0}),function(LogLevel){LogLevel[LogLevel.DEBUG=0]="DEBUG",LogLevel[LogLevel.INFO=1]="INFO",LogLevel[LogLevel.WARNING=2]="WARNING",LogLevel[LogLevel.ERROR=3]="ERROR",LogLevel[LogLevel.OFF=4]="OFF"}(LogLevel=exports.LogLevel||(exports.LogLevel={}));class Log{constructor(namespace){this.currentIds_=[],this.loggedIds_=new Set,this.namespace_=namespace}callIfEnabled_(fn,logLevel,color,...messages){const currentId=this.currentIds_.length>0?this.currentIds_[this.currentIds_.length-1]:null;if((!currentId||!this.loggedIds_.has(currentId))&&logLevel>=Log.ENABLED_LOG_LEVEL_){const usedColor=Log.COLOR_ENABLED_?color:"default";fn(`%c${this.namespace_}%c`,`color: ${usedColor}`,"color: default",...messages)}}static debug(log,...messages){log.callIfEnabled_(console.debug.bind(console),LogLevel.DEBUG,"#8000ff",...messages)}static error(log,...messages){log.callIfEnabled_(console.error.bind(console),LogLevel.ERROR,"#800000",...messages)}static getEnabledLevel(){return Log.ENABLED_LOG_LEVEL_}static groupCollapsed(log,...messages){log.callIfEnabled_(console.groupCollapsed.bind(console),LogLevel.INFO,"#808080",...messages)}static groupEnd(log){log.callIfEnabled_(console.groupEnd.bind(console),LogLevel.INFO,"")}static info(log,...messages){log.callIfEnabled_(console.info.bind(console),LogLevel.INFO,"#00bfff",...messages)}static of(namespace){return new Log(namespace)}static onceEnd(log,id){log.loggedIds_.add(id),log.currentIds_.pop()}static onceId(log,id){log.currentIds_.push(id)}static setColorEnabled(enabled){Log.COLOR_ENABLED_=enabled}static setEnabledLevel(logLevel){Log.ENABLED_LOG_LEVEL_=logLevel}static trace(log){log.callIfEnabled_(console.trace.bind(console),LogLevel.DEBUG,"")}static warn(log,...messages){log.callIfEnabled_(console.warn.bind(console),LogLevel.WARNING,"#ff9f00",...messages)}}Log.COLOR_ENABLED_=!0,Log.ENABLED_LOG_LEVEL_=LogLevel.INFO,exports.Log=Log},"../util/reflect.ts":
/*!**************************!*\
  !*** ../util/reflect.ts ***!
  \**************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class Reflect{static addInitializer(ctor,initializer){const origInitializer=ctor.prototype[Reflect.__initialize];ctor.prototype[Reflect.__initialize]=function(...args){origInitializer&&origInitializer.apply(this,args),initializer.apply(this,args)}}static construct(ctor,args){const instance=new(ctor.bind.apply(ctor,[null].concat(args)));return instance[Reflect.__initialize]instanceof Function&&instance[Reflect.__initialize](instance),instance}static overrideGetter(object,propertyName,newValue){Object.defineProperty(object,propertyName,{get:()=>newValue})}}Reflect.__initialize=Symbol("initialize"),exports.Reflect=Reflect},"./asyncs.ts":
/*!*******************!*\
  !*** ./asyncs.ts ***!
  \*******************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.Asyncs=class Asyncs{static run(fn){return new Promise(resolve=>{window.setTimeout(()=>{resolve(fn())},0)})}}},"./atomic.ts":
/*!*******************!*\
  !*** ./atomic.ts ***!
  \*******************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_disposable_1=__webpack_require__(/*! ../dispose/base-disposable */"../dispose/base-disposable.ts"),error_1=__webpack_require__(/*! ../error */"../error/index.ts"),sequencer_1=__webpack_require__(/*! ./sequencer */"./sequencer.ts");exports.__SEQUENCER=Symbol("sequencer"),exports.atomic=function atomic(){return function(target,_,descriptor){if(!(target instanceof base_disposable_1.BaseDisposable))throw error_1.Errors.assert("target").shouldBeAnInstanceOf(base_disposable_1.BaseDisposable).butWas(target);const originalFn=descriptor.value;return void 0!==originalFn&&(descriptor.value=function(...args){if(!this[exports.__SEQUENCER]){const sequencer=sequencer_1.Sequencer.newInstance();this[exports.__SEQUENCER]=sequencer,this.addDisposable(sequencer)}return this[exports.__SEQUENCER].run(()=>Promise.resolve(originalFn.apply(this,args)))}),descriptor}}},"./atomic_test.ts":
/*!************************!*\
  !*** ./atomic_test.ts ***!
  \************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),__webpack_require__(/*! jasmine */"jasmine");const test_base_1=__webpack_require__(/*! ../test-base */"../test-base.ts");test_base_1.TestBase.setup();const base_disposable_1=__webpack_require__(/*! ../dispose/base-disposable */"../dispose/base-disposable.ts"),mocks_1=__webpack_require__(/*! ../mock/mocks */"../mock/mocks.ts"),atomic_1=__webpack_require__(/*! ./atomic */"./atomic.ts"),sequencer_1=__webpack_require__(/*! ./sequencer */"./sequencer.ts");describe("async.atomic",()=>{let decorator;beforeEach(()=>{decorator=atomic_1.atomic()}),it("should replace the descriptor with a function that sequence the annotated function",()=>__awaiter(this,void 0,void 0,function*(){const mockFunction=jasmine.createSpy("Function"),descriptor=mocks_1.Mocks.object("descriptor");descriptor.value=mockFunction;const mockSequencer=jasmine.createSpyObj("Sequencer",["dispose","run"]);mockSequencer.run.and.returnValue(Promise.resolve()),spyOn(sequencer_1.Sequencer,"newInstance").and.returnValue(mockSequencer);const newDescriptor=decorator(class Class extends base_disposable_1.BaseDisposable{}.prototype,"property",descriptor);test_base_1.assert(newDescriptor).to.equal(descriptor);const mockInstance=jasmine.createSpyObj("Instance",["addDisposable"]);yield descriptor.value.call(mockInstance,1,2),test_base_1.assert(mockSequencer.run).to.haveBeenCalledWith(test_base_1.Matchers.anyFunction()),mockSequencer.run.calls.argsFor(0)[0](),test_base_1.assert(mockFunction).to.haveBeenCalledWith(1,2)})),it("should reuse existing sequencer",()=>__awaiter(this,void 0,void 0,function*(){const descriptor=mocks_1.Mocks.object("descriptor");descriptor.value=(()=>{});const mockSequencer=jasmine.createSpyObj("Sequencer",["run"]);mockSequencer.run.and.returnValue(Promise.resolve());const instance=mocks_1.Mocks.object("instance");instance[atomic_1.__SEQUENCER]=mockSequencer,yield decorator(class Class extends base_disposable_1.BaseDisposable{}.prototype,"property",descriptor).value.call(instance,1,2),test_base_1.assert(mockSequencer.run).to.haveBeenCalledWith(test_base_1.Matchers.anyFunction())})),it("should not throw error if the descriptor has no values",()=>{const descriptor=mocks_1.Mocks.object("descriptor");test_base_1.assert(decorator(class Class extends base_disposable_1.BaseDisposable{}.prototype,"property",descriptor)).to.equal(descriptor)}),it("should throw error if the target is not an instance of BaseDisposable",()=>{class Class{}test_base_1.assert(()=>{decorator(Class.prototype,"property",{})}).to.throwError(/should be an instance of \[BaseDisposable\]/)})})},"./sequencer.ts":
/*!**********************!*\
  !*** ./sequencer.ts ***!
  \**********************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const base_disposable_1=__webpack_require__(/*! ../dispose/base-disposable */"../dispose/base-disposable.ts");class Sequencer extends base_disposable_1.BaseDisposable{constructor(){super(...arguments),this.lastOperation_=Promise.resolve()}run(operation){const newPromise=this.lastOperation_.then(()=>{this.isDisposed()||operation()}).catch(error=>{if(this.isDisposed())throw error;operation()});return this.lastOperation_=newPromise,newPromise}static newInstance(){return new Sequencer}}exports.Sequencer=Sequencer},jasmine:
/*!**************************!*\
  !*** external "jasmine" ***!
  \**************************/
/*! no static exports found */function(module,exports){module.exports=jasmine}});
//# sourceMappingURL=bundle.js.map